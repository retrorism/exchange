{"version":3,"sources":["wp-foundation.js","init-foundation.js"],"names":["isEmpty","obj","length","key","hasOwnProperty","call","createRoute","arr_m","arr_l","arr_c","iconUrl","leaflet_vars","markerUrl","route","L","icon","iconSize","shadowSize","iconAnchor","shadowAnchor","popupAnchor","featureGroup","snakingPause","i","marker","DivIcon","className","html","line","polyline","color","yellowTandem","weight","opacity","dashArray","lineJoin","snakingSpeed","addLayer","marker2","bindPopup","fetchCollaborationsQuery","tags","jQuery","find","filters","object","taxquery","tag","k","data","v","String","mapInitial","post_tag","getRandomProgrammeRound","queryFilters","restFilters","restBase","restUrl","baseUrl","prepareCollaborationMarkers","console","log","locations","markers","cities","lines","collab","name","title","link","participant_id","participant","latlngs","isNumeric","org_lat","push","org_lng","org_city","j","createArchiveRoute","loadMap","baseMapUrl","base","tileLayer","subdomains","undefined","map","layers","maxZoom","minZoom","zoomControl","scrollWheelZoom","attributionControl","setView","attControl","control","attribution","prefix","addTo","addAttribution","fetchCollaborations","loadGrid","removeLayer","routeLayer","when","ajax","url","method","crossDomain","contentType","then","status","request","dataLength","collection","exchange_basics","collectionLength","routes","l","fitBounds","getBounds","pad","getQueryTag","option","tax","document","createElement","item","text","createTextNode","setAttribute","id","slug","addEventListener","event","preventDefault","removeAttr","this","parentNode","remove","appendChild","termOptions","randomTotal","randomN","Math","floor","random","prog","foundation","Object","prototype","location","origin","protocol","host","getFocusTranslate","img_placeholder","img","img_data","dataset","h","offsetHeight","container_h","px_translate","focus_h","max_translate","translate","doFocusTranslate","translateNeg","transform","ready","focus_img_containers","querySelectorAll","img_container","getElementsByClassName","classList","contains","floated_elements","equal_element","nextElementSibling","equal_h","style","height","each","select","on","doLanguageSwitch","lang","index","element","removeClass","hasClass","addClass","value","wrapper","parent","paragraphs","children","last","innerWidth","innerHeight","wrap","$archiveGrid","masonry","itemSelector","termList","term","val","termOption","termData","tagBox","empty","append","attr","e","$moreButton","paged","max_num_pages","posts_per_page","tax_query","success","pagelength","items","griditem","$items","hide","error","toggle","toggleID","animate"],"mappings":"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","file":"scripts.min.js","sourcesContent":["// Speed up calls to hasOwnProperty\nvar hasOwnProperty = Object.prototype.hasOwnProperty,\nbaseUrl = location.origin,\nmapInitial = 1,\nmap,\nrouteLayer;\n\nif (! location.origin) {\n\tbaseUrl = location.protocol + \"//\" + location.host;\n}\n\nif ( location.origin == 'http://localhost' ) {\n  baseUrl = location.origin + \"/tandem\";\n}\n\nfunction isEmpty(obj) {\n    if (obj == null) {\n\t\treturn true;\n\t}\n    if (obj.length > 0) {\n\t\treturn false;\n\t}\n    if (obj.length === 0) {\n\t\treturn true;\n\t}\n    if (typeof obj !== \"object\") {\n\t\treturn true;\n\t}\n    for (var key in obj) {\n        if (hasOwnProperty.call(obj, key)) {\n\t\t\treturn false;\n\t\t}\n    }\n    return true;\n}\n\nvar getFocusTranslate = function( img_placeholder, img ) {\n\timg_data = img_placeholder.parentNode.dataset;\n\tif ( ! img_data ) {\n\t\treturn false;\n\t}\n\tvar h = img.offsetHeight,\n\tcontainer_h =  img_placeholder.offsetHeight,\n\tpx_translate = ( img_data.focus_h * h ) - ( container_h / 2 ),\n\tmax_translate = ( ( h - container_h ) / h ) * 100,\n\ttranslate = ( px_translate / h ) * 100;\n\n\t// console.log( 'image height: ' + h );\n\t// console.log( 'focus point on ' + ( img_data.focus_h * h ) );\n\t// console.log( 'container center ' + ( container_h / 2 ) );\n\t// console.log( 'number of pixels to move: ' + px_translate );\n\t// console.log( 'number of percents to move: ' + translate );\n\t// console.log( 'max percent to move: ' + max_translate );\n\t// If the center of the container is below the focus point, don't move.\n\t// Or: if the translation is downwards, don't move (we're working from top).\n\tif ( px_translate < 0 || translate < 0 ) {\n\t\t//alert( 'translation smaller than 0' );\n\t\treturn false;\n\t}\n\n\tif ( translate > max_translate ) {\n\t\treturn max_translate;\n\t} else {\n\t\treturn translate;\n\t}\n};\n\nvar doFocusTranslate = function( img ) {\n\tvar img_placeholder = img.parentNode;\n\ttranslate = getFocusTranslate( img_placeholder, img );\n\t// Keep the negative, add minus if necessary\n\tif ( translate ) {\n\t\tvar translateNeg = translate > 0 ? -1 * translate : translate,\n\t\ttransform = 'transform: translateY(' + translateNeg + '%);';\n\t\timg.setAttribute( 'style', transform );\n\t}\n};\n\nfunction createRoute(arr_m,arr_l,arr_c) {\n\tvar iconUrl = leaflet_vars.markerUrl,\n\texchange_icon = L.icon({\n\t\ticonUrl: iconUrl,\n\t\ticonSize:     [14, 14], // size of the icon\n\t\tshadowSize:   [0, 0], // size of the shadow\n\t\ticonAnchor:   [7, 7], // point of the icon which will correspond to marker's location\n\t\tshadowAnchor: [4, 62],  // the same for the shadow\n\t\tpopupAnchor:  [0, 0] // point from which the popup should open relative to the iconAnchor\n\t}),\n\troute = L.featureGroup({snakingPause: 500 });\n\tif ( arr_m.length > 0 && arr_l.length > 0 ) {\n\t\tfor ( i = 0; i < arr_l.length; i++ ) {\n\t\t\tvar marker = L.marker( arr_m[i], {\n\t\t\t\ticon : new L.DivIcon({\n\t\t\t\t\tclassName: 'map__marker',\n\t\t\t\t\thtml:   '<img class=\"map__marker__image\" src=\"' + iconUrl + '\">'+\n\t\t\t\t\t\t\t'<span class=\"map__marker__label\">'+arr_c[i]+'</span>'\n\t\t\t\t\t\t})\n\t\t\t});\n\t\t\tvar line = L.polyline( arr_l[i], {\n\t\t\t\tcolor : leaflet_vars.yellowTandem,\n\t\t\t\tclassName: 'map__line',\n\t\t\t\tweight : 6,\n\t\t\t\topacity : 0.9,\n\t\t\t\tdashArray : '12, 10',\n\t\t\t\tlineJoin: 'round',\n\t\t\t\tsnakingSpeed: 200\n\t\t\t} );\n\t\t\troute.addLayer( marker ).addLayer( line );\n\t\t}\n\t\tif ( arr_l.length == 1 ) {\n\t\t\t\tvar marker2 = L.marker( arr_m[i], {\n\t\t\t\t\ticon : new L.DivIcon({\n\t\t\t\t\t\tclassName: 'map__marker',\n\t\t\t\t\t\thtml:   '<img class=\"map__marker__image\" src=\"' + iconUrl + '\">'+\n\t\t\t\t\t\t\t\t'<span class=\"map__marker__label\">'+arr_c[i]+'</span>'\n\t\t\t\t\t\t\t})\n\t\t\t\t} );\n\t\t\t\tmarker2.bindPopup(arr_c[i]);\n\t\t\troute.addLayer( marker2 );\n\t\t}\n\t}\n\treturn route;\n};\n\nfunction fetchCollaborationsQuery() {\n\tvar tags = jQuery('.archive__filter__query-tags').find('a.tag');\n\tvar filters = {\n\t\t'object' : 'collaborations',\n\t\t'taxquery': {},\n\t};\n\tif ( tags.length ) {\n\t\tfor ( var i = 0; i < tags.length; i++ ) {\n\t\t\tvar tag = jQuery( tags[i] );\n\t\t\tvar k = tag.data('tax'),\n\t\t\tv = tag.data('slug');\n\t\t\tif ( ( typeof k === 'string' || k instanceof String )\n\t\t\t\t&& ( typeof v === 'string' || v instanceof String ) ) {\n\t\t\t\tfilters.taxquery[k] = v;\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif ( mapInitial == 1 ) {\n\t\t\tvar post_tag = getRandomProgrammeRound();\n\t\t\tfilters.taxquery = {\n\t\t\t\t'tag' : post_tag\n\t\t\t}\n\t\t\tmapInitial = 0;\n\t\t}\n\t}\n\tvar queryFilters = '',\n\ttaxquery = filters.taxquery;\n\tif ( isEmpty(taxquery) ) {\n\t\treturn null;\n\t} else {\n\t\tfor (var key in filters.taxquery) {\n\t\t\tif (taxquery.hasOwnProperty(key)) {\n\t\t\t\tqueryFilters += '&filter[' + key + ']=' + taxquery[key];\n\t\t\t}\n\t\t}\n\t\tvar restFilters = '?filter[post_status]=publish' + queryFilters + '&filter[orderby]=date&filter[order]=desc',\n\t\trestBase = '/wp-json/wp/v2/' + filters.object,\n\t\trestUrl = baseUrl + restBase + restFilters;\n\t\treturn restUrl;\n\t}\n}\n\nfunction prepareCollaborationMarkers( obj ) {\n\tconsole.log( obj );\n\tvar locations = [],\n\tmarkers = [],\n\tcities = [],\n\tlines = [],\n\tcollab = {\n\t\t'name' : obj.title,\n\t\t'link' : obj.link\n\t};\n\tif ( isEmpty( obj.locations ) ) {\n\t\treturn null;\n\t}\n\tfor (var participant_id in obj.locations ) {\n\t\tif ( obj.locations.hasOwnProperty(participant_id) ) {\n\t\t\tvar participant = obj.locations[participant_id],\n\t\t\tlatlngs = []\n\t\t\tif ( jQuery.isNumeric( participant.org_lat ) ) {\n\t\t\t\tlatlngs.push( participant.org_lat );\n\t\t\t}\n\t\t\tif ( jQuery.isNumeric( participant.org_lng ) ) {\n\t\t\t\tlatlngs.push( participant.org_lng );\n\t\t\t}\n\t\t\tif ( latlngs.length == 2 ) {\n\t\t\t\tlocations.push( latlngs );\n\t\t\t}\n\t\t\tif ( '' != participant.org_city ) {\n\t\t\t\tcities.push( participant.org_city );\n\t\t\t}\n\t\t}\n\t}\n\tvar length = locations.length;\n\t// Adding markers and lines to their respective arrays.\n\tfor ( var j = 0; j < length; j++ ) {\n\t\tmarkers.push( locations[j] );\n\t\tif ( j === length - 1 ) {\n\t\t\tif ( length > 2 ) {\n\t\t\t\tlines.push( [ locations[j], locations[0] ] );\n\t\t\t}\n\t\t} else {\n\t\t\tlines.push( [ locations[j], locations[j+1] ] );\n\t\t}\n\t}\n\tif ( length == 2 ) {\n\t\tmarkers.push( locations[1] );\n\t}\n\tvar route = createArchiveRoute(collab,markers,lines,cities);\n\treturn route;\n}\n\nfunction createArchiveRoute(collab,arr_m,arr_l,arr_c) {\n\tvar iconUrl = leaflet_vars.markerUrl,\n\texchange_icon = L.icon({\n\t\ticonUrl: iconUrl,\n\t\ticonSize:     [14, 14], // size of the icon\n\t\tshadowSize:   [0, 0], // size of the shadow\n\t\ticonAnchor:   [7, 7], // point of the icon which will correspond to marker's location\n\t\tshadowAnchor: [4, 62],  // the same for the shadow\n\t\tpopupAnchor:  [0, 0] // point from which the popup should open relative to the iconAnchor\n\t}),\n\troute = L.featureGroup({snakingPause: 500 });\n\tif ( arr_m.length > 0 && arr_l.length > 0 ) {\n\t\tfor ( i = 0; i < arr_l.length; i++ ) {\n\t\t\tvar marker = L.marker( arr_m[i], {\n\t\t\t\ticon : new L.DivIcon({\n\t\t\t\t\tclassName: 'map__marker',\n\t\t\t\t\thtml:   '<img class=\"map__marker__image\" src=\"' + iconUrl + '\">'\n\t\t\t\t\t\t})\n\t\t\t});\n\t\t\tvar line = L.polyline( arr_l[i], {\n\t\t\t\tcolor : leaflet_vars.yellowTandem,\n\t\t\t\tclassName: 'map__line',\n\t\t\t\tweight : 6,\n\t\t\t\topacity : 0.9,\n\t\t\t\tdashArray : '12, 10',\n\t\t\t\tlineJoin: 'round',\n\t\t\t\tsnakingSpeed: 200\n\t\t\t} );\n\t\t\troute.addLayer( marker ).addLayer( line );\n\t\t}\n\t\tif ( arr_l.length == 1 ) {\n\t\t\t\tvar marker2 = L.marker( arr_m[i], {\n\t\t\t\t\ticon : new L.DivIcon({\n\t\t\t\t\t\tclassName: 'map__marker',\n\t\t\t\t\t\thtml:   '<img class=\"map__marker__image\" src=\"' + iconUrl + '\">'\n\t\t\t\t\t\t\t})\n\t\t\t\t} );\n\t\t\t\tmarker2.bindPopup(arr_c[i]);\n\t\t\troute.addLayer( marker2 );\n\t\t}\n\t\troute.bindPopup('<a href=\"' + collab.link + '\">' + collab.name + '</a>');\n\t}\n\treturn route;\n};\n\nfunction loadMap() {\n\tvar baseMapUrl = 'https://api.mapbox.com/styles/v1/retrorism/cio2pv2ft001ybvm8qb4da6f9/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoicmV0cm9yaXNtIiwiYSI6IlhRWTE0d2cifQ.-Wi_jReZU4Wz_owPnVZDwQ',\n\tbase = L.tileLayer(baseMapUrl, {subdomains: '1234'});\n\tif ( map == undefined ) {\n\t\tmap = L.map('leaflet-archive-map',{\n\t\t\tlayers: [base],\n\t\t\tmaxZoom: 20,\n\t\t\tminZoom: 0,\n\t\t\tzoomControl: 1,\n\t\t\tscrollWheelZoom: 0,\n\t\t\tattributionControl: false\n\t\t}).setView([48, 16], 4);\n\t\tvar attControl = L.control.attribution({prefix:false}).addTo(map);attControl.addAttribution('Tiles Courtesy of <a href=\"http://www.mapbox.com/\" target=\"_blank\">MapBox</a> Â© <a href=\"http://www.openstreetmap.org/\">OpenStreetMap</a> contributors');\n\t}\n\tfetchCollaborations();\n}\n\nfunction loadGrid() {\n\tconsole.log( 'grid loaded' );\n}\n\nfunction fetchCollaborations() {\n\tvar restUrl = fetchCollaborationsQuery();\n\tif ( restUrl === null ) {\n\t\tconsole.log( 'emptying map' );\n\t\tmap.removeLayer(routeLayer);\n\t} else {\n\t\tconsole.log('called with ' + restUrl );\n\t\tjQuery.when(\n\t\t\tjQuery.ajax({\n\t\t\t\turl: restUrl,\n\t\t\t\tmethod: 'GET',\n\t\t\t\tcrossDomain: true,\n\t\t\t\tcontentType: 'application/json',\n\t\t\t})\n\t\t).then(\n\t\t\tfunction( data, status, request ) {\n\t\t\t\t// console.log( 'X-WP-Total: ' + request.getResponseHeader('X-WP-Total') );\n\t\t\t\t// console.log( 'X-WP-TotalPages: ' + request.getResponseHeader('X-WP-TotalPages') );\n\t\t\t\tvar dataLength = data.length,\n\t\t\t\tcollection = [];\n\t\t\t\tif ( dataLength > 0 ) {\n\t\t\t\t\tfor ( var k = 0; k < dataLength; k++ ) {\n\t\t\t\t\t\tcollection.push( data[k].exchange_basics.data );\n\t\t\t\t\t}\n\t\t\t\t\tcollectionLength = collection.length;\n\t\t\t\t\troutes = [];\n\t\t\t\t\tfor ( var l = 0; l < collectionLength; l++ ) {\n\t\t\t\t\t\tvar route = prepareCollaborationMarkers( collection[l] );\n\t\t\t\t\t\tif ( route !== null ) {\n\t\t\t\t\t\t\troutes.push(route);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tconsole.log( routes );\n\t\t\t\t\tif ( routeLayer !== undefined ) {\n\t\t\t\t\t\tmap.removeLayer(routeLayer);\n\t\t\t\t\t}\n\t\t\t\t\tif ( routes.length > 0 ) {\n\t\t\t\t\t\trouteLayer = L.featureGroup(routes).addTo(map);\n\t\t\t\t\t\tmap.fitBounds( routeLayer.getBounds().pad(0.033) );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t)\n\t}\n}\n\nfunction getQueryTag( data, option ) {\n\tconsole.log(data.tax);\n\tvar tag = document.createElement('a'),\n\titem = document.createElement('li'),\n\ttext = document.createTextNode( data.name );\n\ttag.setAttribute( 'data-term_id',data.id );\n\ttag.setAttribute( 'data-slug',data.slug );\n\ttag.setAttribute( 'data-tax',data.tax );\n\ttag.setAttribute( 'title',data.name );\n\ttag.setAttribute( 'href','#' );\n\ttag.addEventListener('click',function( event ) {\n\t\tevent.preventDefault();\n\t\toption.removeAttr('selected');\n\t\tthis.parentNode.remove();\n\t\tfetchCollaborations();\n\t})\n\ttag.className = 'tag query-tag' + ' ' + data.tax;\n\ttag.appendChild(text);\n\titem.appendChild(tag);\n\treturn item;\n}\n\nfunction getRandomProgrammeRound() {\n\tvar termOptions = jQuery('.archive__filter').find('.archive__filter__tax-datalist[data-tax=tag]').find('option');\n\tif ( termOptions.length ) {\n\t\tvar randomTotal = termOptions.length,\n\t\trandomN = Math.floor(Math.random() * randomTotal);\n\t\tconsole.log(randomN);\n\t\tprog = jQuery( termOptions[randomN] );\n\t\treturn prog.data('slug');\n\t}\n}\n\n\njQuery(document).foundation();\n/*\nThese functions make sure WordPress\nand Foundation play nice together.\n*/\n\njQuery(document).ready(function() {\n\n\t// var baseUrl = location.origin;\n\t//\n\t// if (! location.origin) {\n\t// \tbaseUrl = location.protocol + \"//\" + location.host;\n\t// }\n\t//\n\t// if ( location.origin == 'http://localhost' ) {\n\t//   baseUrl = location.origin + \"/tandem\";\n //  \t}\n\n\tvar focus_img_containers = document.querySelectorAll('.focus');\n\tfor ( var i = 0; i < focus_img_containers.length; i++ ) {\n  \t\tvar img_container = focus_img_containers[i];\n\t\timg = img_container.getElementsByClassName('image--main')[0];\n\t\tif ( ! img.classList.contains( 'lazy' ) ) {\n\t\t\t//console.log('no lazy image detected');\n\t\t\tdoFocusTranslate( img );\n\t\t}\n\t}\n\n\tvar floated_elements = document.querySelectorAll('.floated');\n\tfor (var j = 0; j < floated_elements.length; j++ ) {\n\t\tvar equal_element = floated_elements[j].nextElementSibling,\n\t\th = floated_elements[j].offsetHeight,\n\t\tequal_h = equal_element.offsetHeight;\n\t\t// console.log( floated_elements[j] );\n\t\t// console.log( equal_element );\n\t\t// console.log( 'neighbour: ' + equal_h + ' px');\n\t\tif ( h > equal_h ) {\n\t\t\tequal_element.style.height = h + 'px';\n\t\t}\n\t}\n\n/* \tjQuery('#gform_6 #input_6_7').change(function(){\n    var attendees = jQuery(this).val();\n    gfRepeater_setRepeater(6, 1, attendees);\n}); */\n\n\tjQuery('.translatedparagraph--has_translations').each( function() {\n\t\tvar select = jQuery( this ).find('.translation-select');\n\t\tselect.on('change', function() {\n\t\t\tvar lang = 'paragraph--' + this.value;\n\t\t\tfunction doLanguageSwitch( lang ) {\n\t\t\t\treturn function( index, element) {\n\t\t\t\t\tjQuery( this ).removeClass('show');\n\t\t\t\t\tif ( jQuery( this ).hasClass( lang ) ) {\n\t\t\t\t\t\tjQuery( this ).addClass('show');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tvar wrapper = jQuery( this ).parent().parent('.translatedparagraph--has_translations');\n\t\t\tparagraphs = wrapper.children('.translatedparagraph__paragraph');\n\t\t\tparagraphs.each( doLanguageSwitch( lang ) );\n\t\t});\n\t});\n\n\tjQuery('.image--main').each( function() {\n\t\tconsole.log( jQuery(this).height() );\n\t});\n\n    // Remove empty P tags created by WP inside of Accordion and Orbit\n    jQuery('.accordion p:empty, .orbit p:empty').remove();\n\n\t // Makes sure last grid item floats left\n\tjQuery('.archive__grid .columns', 'relatedgrid .columns').last().addClass( 'end' );\n\n\t// Adds Flex Video to YouTube and Vimeo Embeds\n\tjQuery('iframe[src*=\"youtube.com\"], iframe[src*=\"vimeo.com\"]').each(function() {\n\t\tif ( jQuery(this).innerWidth() / jQuery(this).innerHeight() > 1.5 ) {\n\t\t  jQuery(this).wrap(\"<div class='widescreen flex-video'/>\");\n\t\t} else {\n\t\t  jQuery(this).wrap(\"<div class='flex-video'/>\");\n\t\t}\n\t});\n\n  // Archive functions\n\tif ( jQuery('body').hasClass('archive') ) {\n\t\tvar $archiveGrid = jQuery('.masonry').masonry({\n\t\t  \"itemSelector\": \".archive__grid__griditem\"\n\t\t});\n\n\t\tjQuery('.archive__filter__button').each(function() {\n\t\t\tjQuery(this).on('click', function() {\n\t\t\t\tvar tax = jQuery(this).data('tax'),\n\t\t\t\ttermList = jQuery(this).parent().find('.archive__filter__datalist'),\n\t\t\t\tterm = termList.val();\n\t\t\t\tif ( term !== null && term !== undefined && term !== '' ) {\n\t\t\t\t\tvar termOption = jQuery('.archive__filter').find('.archive__filter__tax-datalist[data-tax=' + tax + ']').find('option[value=\"' + term + '\"]:not(:selected)');\n\t\t\t\t\tif ( termOption.length ) {\n\t\t\t\t\t\tvar termData = termOption.data();\n\t\t\t\t\t\ttermData.name = term;\n\t\t\t\t\t\ttermData.tax = tax;\n\t\t\t\t\t\t// Pass term option element object, so it can be removed on click\n\t\t\t\t\t\tvar tag = getQueryTag(termData, termOption),\n\t\t\t\t\t\ttagBox = jQuery('.archive__filter__query-tags ul');\n\t\t\t\t\t\ttagBox.empty().append( tag );\n\t\t\t\t\t\ttermOption.attr('selected','selected');\n\t\t\t\t\t\tfetchCollaborations();\n\t\t\t\t\t}\n\t\t\t\t\ttermList.val('');\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\n\t\tjQuery('.archive__button').on('click',function( e ) {\n\t\t\te.preventDefault();\n\t\t\tvar $moreButton = jQuery(this),\n\t\t\tpaged = $moreButton.data('paged'),\n\t\t\tmax_num_pages = $moreButton.data('max_num_pages'),\n\t\t\tobject = $moreButton.data('object'),\n\t\t\tposts_per_page = $moreButton.data('posts_per_page'),\n\t\t\ttax_query = $moreButton.data('tax_query');\n\t\t\tif ( tax_query ) {\n\t\t\t\trestBase = '/wp-json/exchange/v1/' + object + '/' + tax_query;\n\t\t\t\tfilters = '?page=' + ( paged + 2 ) + '&posts_per_page=' + posts_per_page;\n\t\t\t} else {\n\t\t\t\trestBase = '/wp-json/wp/v2/' + object;\n\t\t\t\tfilters = '?filter[post_status]=publish&filter[posts_per_page]=' + posts_per_page + '&page=' + ( paged + 2 ) + '&filter[orderby]=date&filter[order]=desc';\n\t\t\t}\n\t\t\tvar restUrl = baseUrl + restBase + filters;\n\t\t\tif ( ( paged + 1 ) < max_num_pages ) {\n\t\t\t\tjQuery.ajax({\n\t\t\t\t\turl: restUrl,\n\t\t\t\t\tmethod: 'GET',\n\t\t\t\t\tcrossDomain: true,\n\t\t\t\t\tcontentType: 'application/json',\n\t\t\t\t\tsuccess: function( data, status, request ) {\n\t\t\t\t\t\t// console.log( 'X-WP-Total: ' + request.getResponseHeader('X-WP-Total') );\n\t\t\t\t\t\t// console.log( 'X-WP-TotalPages: ' + request.getResponseHeader('X-WP-TotalPages') );\n\t\t\t\t\t\tconsole.log( restUrl );\n\t\t\t\t\t\tvar pagelength = data.length,\n\t\t\t\t\t\t\titems = '';\n\t\t\t\t\t\tfor ( var i = 0; i < pagelength; i++ ) {\n\t\t\t\t\t\t\titems = items + data[i].exchange_basics.griditem;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar $items = jQuery( items );\n\t\t\t\t\t\t$archiveGrid.append( $items ).masonry( 'appended',$items ).masonry();\n\t\t\t\t\t\tpaged = paged + 1;\n\t\t\t\t\t\t$moreButton.data('paged', paged );\n\t\t\t\t\t\tif ( paged + 1 == max_num_pages ) {\n\t\t\t\t\t\t\t$moreButton.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\terror: function( error ) {\n\t\t\t\t\t\tconsole.log( error );\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\tif ( jQuery('body').hasClass('post-type-archive-collaboration') ) {\n\n\t\tjQuery('.archive__view__toggle').find('a').each( function() {\n\t\t\tjQuery(this).on('click', function( e ) {\n\t\t\t\tvar toggle = jQuery(this),\n\t\t\t\ttoggleID = toggle.data('exchange-toggle');\n\t\t\t\te.preventDefault();\n\t\t\t\tif ( ! toggle.hasClass('active') ) {\n\t\t\t\t\ttoggle.addClass('active');\n\t\t\t\t\tif (  toggleID == 'archive__view--map' ) {\n\t\t\t\t\t\tjQuery('.grid-toggle').removeClass('active');\n\t\t\t\t\t\tjQuery('#archive__view--map').removeClass('hide').animate({'height':'500px'}, 500, loadMap());\n\t\t\t\t\t\tjQuery('#archive__view--grid').addClass('hide');\n\t\t\t\t\t}\n\t\t\t\t\tif ( toggleID == 'archive__view--grid' ) {\n\t\t\t\t\t\tjQuery('.map-toggle').removeClass('active');\n\t\t\t\t\t\tjQuery('#archive__view--grid').removeClass('hide');\n\t\t\t\t\t\tloadGrid();\n\t\t\t\t\t\tjQuery('#archive__view--map').animate({'height':'0'}, 500, function(){\n\t\t\t\t\t\t\tjQuery(this).addClass('hide')\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tif ( ! jQuery('#archive__view--map').hasClass('hide') ) {\n\t\t\tloadMap();\n\t\t}\n\n\t\t// route = createRoute([[41.0082376,28.9783589],[45.8609375,25.7885796],[45.8609375,25.7885796]],[[[41.0082376,28.9783589],[45.8609375,25.7885796]]],[\"Istanbul\",\"Sfantu Gheorghe\",\"\"]);\n\t\t// route.bindPopup('<a class=\\\"\\\" href=\\\"http://localhost/tandem/collaborations/looking-forat-the-invisible/\\\" title=\\\"Navigate to Looking For/At The Invisible\\\">Looking For/At The Invisible</a>');\n\t\t// route.addTo( map );\n\t\t// map.fitBounds( route.getBounds().pad(0.033) );\n\t\t// route.snakeIn();\n\t}\n\n\n});\n","jQuery(document).foundation();"],"sourceRoot":"/source/"}