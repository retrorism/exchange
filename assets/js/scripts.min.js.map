{"version":3,"sources":["wp-foundation.js","init-foundation.js"],"names":["isEmpty","obj","length","key","hasOwnProperty","call","createRoute","arr_m","arr_l","arr_c","iconUrl","leaflet_vars","markerUrl","route","L","icon","iconSize","shadowSize","iconAnchor","shadowAnchor","popupAnchor","featureGroup","snakingPause","i","marker","DivIcon","className","html","line","polyline","color","yellowTandem","weight","opacity","dashArray","lineJoin","snakingSpeed","addLayer","marker2","bindPopup","createArchiveRoute","collab","link","name","getQueryTag","data","option","tag","document","createElement","item","text","createTextNode","setAttribute","id","slug","tax","addEventListener","event","preventDefault","removeAttr","this","parentNode","remove","fetchCollaborations","appendChild","getRandomProgrammeRound","termOptions","jQuery","find","randomTotal","randomN","Math","floor","random","console","log","prog","fetchCollaborationsQuery","tags","filters","object","taxquery","k","v","String","mapInitial","post_tag","queryFilters","restFilters","restBase","restUrl","baseUrl","map","removeLayer","routeLayer","when","ajax","url","method","crossDomain","contentType","then","status","request","dataLength","collection","push","exchange_basics","collectionLength","routes","l","prepareCollaborationMarkers","undefined","layerGroup","addTo","locations","markers","cities","lines","title","participant_id","participant","latlngs","isNumeric","org_lat","org_lng","org_city","j","foundation","Object","prototype","location","origin","protocol","host","getFocusTranslate","img_placeholder","img","img_data","dataset","h","offsetHeight","container_h","px_translate","focus_h","max_translate","translate","doFocusTranslate","translateNeg","transform","ready","focus_img_containers","querySelectorAll","img_container","getElementsByClassName","classList","contains","floated_elements","equal_element","nextElementSibling","equal_h","style","height","each","select","on","doLanguageSwitch","lang","index","element","removeClass","hasClass","addClass","value","wrapper","parent","paragraphs","children","last","innerWidth","innerHeight","wrap","$archiveGrid","masonry","itemSelector","termList","term","val","termOption","termData","tagBox","empty","append","attr","e","$moreButton","paged","max_num_pages","posts_per_page","tax_query","success","pagelength","items","griditem","$items","hide","error","baseMapUrl","base","tileLayer","subdomains","layers","maxZoom","minZoom","zoomControl","scrollWheelZoom","attributionControl","setView","attControl","control","attribution","prefix","addAttribution"],"mappings":"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","file":"scripts.min.js","sourcesContent":["// Speed up calls to hasOwnProperty\nvar hasOwnProperty = Object.prototype.hasOwnProperty,\nbaseUrl = location.origin,\nmapInitial = 1,\nmap,\nrouteLayer;\n\nif (! location.origin) {\n\tbaseUrl = location.protocol + \"//\" + location.host;\n}\n\nif ( location.origin == 'http://localhost' ) {\n  baseUrl = location.origin + \"/tandem\";\n}\n\nfunction isEmpty(obj) {\n    if (obj == null) {\n\t\treturn true;\n\t}\n    if (obj.length > 0) {\n\t\treturn false;\n\t}\n    if (obj.length === 0) {\n\t\treturn true;\n\t}\n    if (typeof obj !== \"object\") {\n\t\treturn true;\n\t}\n    for (var key in obj) {\n        if (hasOwnProperty.call(obj, key)) {\n\t\t\treturn false;\n\t\t}\n    }\n    return true;\n}\n\nvar getFocusTranslate = function( img_placeholder, img ) {\n\timg_data = img_placeholder.parentNode.dataset;\n\tif ( ! img_data ) {\n\t\treturn false;\n\t}\n\tvar h = img.offsetHeight,\n\tcontainer_h =  img_placeholder.offsetHeight,\n\tpx_translate = ( img_data.focus_h * h ) - ( container_h / 2 ),\n\tmax_translate = ( ( h - container_h ) / h ) * 100,\n\ttranslate = ( px_translate / h ) * 100;\n\n\t// console.log( 'image height: ' + h );\n\t// console.log( 'focus point on ' + ( img_data.focus_h * h ) );\n\t// console.log( 'container center ' + ( container_h / 2 ) );\n\t// console.log( 'number of pixels to move: ' + px_translate );\n\t// console.log( 'number of percents to move: ' + translate );\n\t// console.log( 'max percent to move: ' + max_translate );\n\t// If the center of the container is below the focus point, don't move.\n\t// Or: if the translation is downwards, don't move (we're working from top).\n\tif ( px_translate < 0 || translate < 0 ) {\n\t\t//alert( 'translation smaller than 0' );\n\t\treturn false;\n\t}\n\n\tif ( translate > max_translate ) {\n\t\treturn max_translate;\n\t} else {\n\t\treturn translate;\n\t}\n};\n\nvar doFocusTranslate = function( img ) {\n\tvar img_placeholder = img.parentNode;\n\ttranslate = getFocusTranslate( img_placeholder, img );\n\t// Keep the negative, add minus if necessary\n\tif ( translate ) {\n\t\tvar translateNeg = translate > 0 ? -1 * translate : translate,\n\t\ttransform = 'transform: translateY(' + translateNeg + '%);';\n\t\timg.setAttribute( 'style', transform );\n\t}\n};\n\nfunction createRoute(arr_m,arr_l,arr_c) {\n\tvar iconUrl = leaflet_vars.markerUrl,\n\texchange_icon = L.icon({\n\t\ticonUrl: iconUrl,\n\t\ticonSize:     [14, 14], // size of the icon\n\t\tshadowSize:   [0, 0], // size of the shadow\n\t\ticonAnchor:   [7, 7], // point of the icon which will correspond to marker's location\n\t\tshadowAnchor: [4, 62],  // the same for the shadow\n\t\tpopupAnchor:  [0, 0] // point from which the popup should open relative to the iconAnchor\n\t}),\n\troute = L.featureGroup({snakingPause: 500 });\n\tif ( arr_m.length > 0 && arr_l.length > 0 ) {\n\t\tfor ( i = 0; i < arr_l.length; i++ ) {\n\t\t\tvar marker = L.marker( arr_m[i], {\n\t\t\t\ticon : new L.DivIcon({\n\t\t\t\t\tclassName: 'map__marker',\n\t\t\t\t\thtml:   '<img class=\"map__marker__image\" src=\"' + iconUrl + '\">'+\n\t\t\t\t\t\t\t'<span class=\"map__marker__label\">'+arr_c[i]+'</span>'\n\t\t\t\t\t\t})\n\t\t\t});\n\t\t\tvar line = L.polyline( arr_l[i], {\n\t\t\t\tcolor : leaflet_vars.yellowTandem,\n\t\t\t\tclassName: 'map__line',\n\t\t\t\tweight : 6,\n\t\t\t\topacity : 0.9,\n\t\t\t\tdashArray : '12, 10',\n\t\t\t\tlineJoin: 'round',\n\t\t\t\tsnakingSpeed: 200\n\t\t\t} );\n\t\t\troute.addLayer( marker ).addLayer( line );\n\t\t}\n\t\tif ( arr_l.length == 1 ) {\n\t\t\t\tvar marker2 = L.marker( arr_m[i], {\n\t\t\t\t\ticon : new L.DivIcon({\n\t\t\t\t\t\tclassName: 'map__marker',\n\t\t\t\t\t\thtml:   '<img class=\"map__marker__image\" src=\"' + iconUrl + '\">'+\n\t\t\t\t\t\t\t\t'<span class=\"map__marker__label\">'+arr_c[i]+'</span>'\n\t\t\t\t\t\t\t})\n\t\t\t\t} );\n\t\t\t\tmarker2.bindPopup(arr_c[i]);\n\t\t\troute.addLayer( marker2 );\n\t\t}\n\t}\n\treturn route;\n};\n\nfunction createArchiveRoute(collab,arr_m,arr_l,arr_c) {\n\tvar iconUrl = leaflet_vars.markerUrl,\n\texchange_icon = L.icon({\n\t\ticonUrl: iconUrl,\n\t\ticonSize:     [14, 14], // size of the icon\n\t\tshadowSize:   [0, 0], // size of the shadow\n\t\ticonAnchor:   [7, 7], // point of the icon which will correspond to marker's location\n\t\tshadowAnchor: [4, 62],  // the same for the shadow\n\t\tpopupAnchor:  [0, 0] // point from which the popup should open relative to the iconAnchor\n\t}),\n\troute = L.featureGroup({snakingPause: 500 });\n\tif ( arr_m.length > 0 && arr_l.length > 0 ) {\n\t\tfor ( i = 0; i < arr_l.length; i++ ) {\n\t\t\tvar marker = L.marker( arr_m[i], {\n\t\t\t\ticon : new L.DivIcon({\n\t\t\t\t\tclassName: 'map__marker',\n\t\t\t\t\thtml:   '<img class=\"map__marker__image\" src=\"' + iconUrl + '\">'\n\t\t\t\t\t\t})\n\t\t\t});\n\t\t\tvar line = L.polyline( arr_l[i], {\n\t\t\t\tcolor : leaflet_vars.yellowTandem,\n\t\t\t\tclassName: 'map__line',\n\t\t\t\tweight : 6,\n\t\t\t\topacity : 0.9,\n\t\t\t\tdashArray : '12, 10',\n\t\t\t\tlineJoin: 'round',\n\t\t\t\tsnakingSpeed: 200\n\t\t\t} );\n\t\t\troute.addLayer( marker ).addLayer( line );\n\t\t}\n\t\tif ( arr_l.length == 1 ) {\n\t\t\t\tvar marker2 = L.marker( arr_m[i], {\n\t\t\t\t\ticon : new L.DivIcon({\n\t\t\t\t\t\tclassName: 'map__marker',\n\t\t\t\t\t\thtml:   '<img class=\"map__marker__image\" src=\"' + iconUrl + '\">'\n\t\t\t\t\t\t\t})\n\t\t\t\t} );\n\t\t\t\tmarker2.bindPopup(arr_c[i]);\n\t\t\troute.addLayer( marker2 );\n\t\t}\n\t\troute.bindPopup('<a href=\"' + collab.link + '\">' + collab.name + '</a>');\n\t}\n\treturn route;\n};\n\nfunction getQueryTag( data, option ) {\n\tvar tag = document.createElement('a'),\n\titem = document.createElement('li'),\n\ttext = document.createTextNode( data.name );\n\ttag.setAttribute( 'data-term_id',data.id );\n\ttag.setAttribute( 'data-slug',data.slug );\n\ttag.setAttribute( 'data-tax',data.tax );\n\ttag.setAttribute( 'title',data.name );\n\ttag.setAttribute( 'href','#' );\n\ttag.addEventListener('click',function( event ) {\n\t\tevent.preventDefault();\n\t\toption.removeAttr('selected');\n\t\tthis.parentNode.remove();\n\t\tfetchCollaborations();\n\t})\n\ttag.className = 'tag query-tag' + ' ' + data.tax;\n\ttag.appendChild(text);\n\titem.appendChild(tag);\n\treturn item;\n}\n\nfunction getRandomProgrammeRound() {\n\tvar termOptions = jQuery('.archive__filter').find('.archive__filter__tax-datalist[data-tax=post_tag]').find('option');\n\tif ( termOptions.length ) {\n\t\tvar randomTotal = termOptions.length,\n\t\trandomN = Math.floor(Math.random() * randomTotal);\n\t\tconsole.log(randomN);\n\t\tprog = jQuery( termOptions[randomN] );\n\t\treturn prog.data('slug');\n\t}\n}\n\nfunction fetchCollaborationsQuery() {\n\tvar tags = jQuery('.archive__filter__query-tags').find('a.tag');\n\tconsole.log( tags );\n\tvar filters = {\n\t\t'object' : 'collaborations',\n\t\t'taxquery': {},\n\t};\n\tif ( tags.length ) {\n\t\tfor ( var i = 0; i < tags.length; i++ ) {\n\t\t\tvar tag = jQuery( tags[i] );\n\t\t\tvar k = tag.data('tax'),\n\t\t\tv = tag.data('slug');\n\t\t\tif ( ( typeof k === 'string' || k instanceof String )\n\t\t\t \t&& ( typeof v === 'string' || v instanceof String ) ) {\n\t\t\t\tfilters.taxquery[k] = v;\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif ( mapInitial == 1 ) {\n\t\t\tvar post_tag = getRandomProgrammeRound();\n\t\t\tfilters.taxquery = {\n\t\t\t\t'tag' : post_tag\n\t\t\t}\n\t\t\tmapInitial = 0;\n\t\t}\n\t}\n\tvar queryFilters = '',\n\ttaxquery = filters.taxquery;\n\tif ( isEmpty(taxquery) ) {\n\t\treturn null;\n\t} else {\n\t\tfor (var key in filters.taxquery) {\n\t\t\tif (taxquery.hasOwnProperty(key)) {\n\t\t\t\tqueryFilters += '&filter[' + key + ']=' + taxquery[key];\n\t\t\t}\n\t\t}\n\t\tvar restFilters = '?filter[post_status]=publish' + queryFilters + '&filter[orderby]=date&filter[order]=desc',\n\t\trestBase = '/wp-json/wp/v2/' + filters.object,\n\t\trestUrl = baseUrl + restBase + restFilters;\n\t\tconsole.log( filters );\n\t\treturn restUrl;\n\t}\n}\n\nfunction fetchCollaborations() {\n\tvar restUrl = fetchCollaborationsQuery();\n\tif ( restUrl === null ) {\n\t\tconsole.log( 'emptying map' );\n\t\tmap.removeLayer(routeLayer);\n\t} else {\n\t\tconsole.log('called with ' + restUrl );\n\t\tjQuery.when(\n\t\t\tjQuery.ajax({\n\t\t\t\turl: restUrl,\n\t\t\t\tmethod: 'GET',\n\t\t\t\tcrossDomain: true,\n\t\t\t\tcontentType: 'application/json',\n\t\t\t})\n\t\t).then(\n\t\t\tfunction( data, status, request ) {\n\t\t\t\t// console.log( 'X-WP-Total: ' + request.getResponseHeader('X-WP-Total') );\n\t\t\t\t// console.log( 'X-WP-TotalPages: ' + request.getResponseHeader('X-WP-TotalPages') );\n\t\t\t\tvar dataLength = data.length,\n\t\t\t\tcollection = [];\n\t\t\t\tif ( dataLength > 0 ) {\n\t\t\t\t\tfor ( var k = 0; k < dataLength; k++ ) {\n\t\t\t\t\t\tcollection.push( data[k].exchange_basics.data );\n\t\t\t\t\t}\n\t\t\t\t\tcollectionLength = collection.length;\n\t\t\t\t\troutes = [];\n\t\t\t\t\tfor ( var l = 0; l < collectionLength; l++ ) {\n\t\t\t\t\t\tvar route = prepareCollaborationMarkers( collection[l] );\n\t\t\t\t\t\tif ( route !== null ) {\n\t\t\t\t\t\t\troutes.push(route);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tconsole.log( routes );\n\t\t\t\t\tif ( routeLayer !== undefined ) {\n\t\t\t\t\t\tmap.removeLayer(routeLayer);\n\t\t\t\t\t}\n\t\t\t\t\tif ( routes.length > 0 ) {\n\t\t\t\t\t\trouteLayer = L.layerGroup(routes).addTo(map);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t)\n\t}\n}\n\nfunction prepareCollaborationMarkers( obj ) {\n\tconsole.log( obj );\n\tvar locations = [],\n\tmarkers = [],\n\tcities = [],\n\tlines = [],\n\tcollab = {\n\t\t'name' : obj.title,\n\t\t'link' : obj.link\n\t};\n\tif ( isEmpty( obj.locations ) ) {\n\t\treturn null;\n\t}\n\tfor (var participant_id in obj.locations ) {\n\t\tif ( obj.locations.hasOwnProperty(participant_id) ) {\n\t\t\tvar participant = obj.locations[participant_id],\n\t\t\tlatlngs = []\n\t\t\tif ( jQuery.isNumeric( participant.org_lat ) ) {\n\t\t\t\tlatlngs.push( participant.org_lat );\n\t\t\t}\n\t\t\tif ( jQuery.isNumeric( participant.org_lng ) ) {\n\t\t\t\tlatlngs.push( participant.org_lng );\n\t\t\t}\n\t\t\tif ( latlngs.length == 2 ) {\n\t\t\t\tlocations.push( latlngs );\n\t\t\t}\n\t\t\tif ( '' != participant.org_city ) {\n\t\t\t\tcities.push( participant.org_city );\n\t\t\t}\n\t\t}\n\t}\n\tvar length = locations.length;\n\t// Adding markers and lines to their respective arrays.\n\tfor ( var j = 0; j < length; j++ ) {\n\t\tmarkers.push( locations[j] );\n\t\tif ( j === length - 1 ) {\n\t\t\tif ( length > 2 ) {\n\t\t\t\tlines.push( [ locations[j], locations[0] ] );\n\t\t\t}\n\t\t} else {\n\t\t\tlines.push( [ locations[j], locations[j+1] ] );\n\t\t}\n\t}\n\tif ( length == 2 ) {\n\t\tmarkers.push( locations[1] );\n\t}\n\tvar route = createArchiveRoute(collab,markers,lines,cities);\n\treturn route;\n\n}\n\njQuery(document).foundation();\n/*\nThese functions make sure WordPress\nand Foundation play nice together.\n*/\n\njQuery(document).ready(function() {\n\n\t// var baseUrl = location.origin;\n\t//\n\t// if (! location.origin) {\n\t// \tbaseUrl = location.protocol + \"//\" + location.host;\n\t// }\n\t//\n\t// if ( location.origin == 'http://localhost' ) {\n\t//   baseUrl = location.origin + \"/tandem\";\n //  \t}\n\n\tvar focus_img_containers = document.querySelectorAll('.focus');\n\tfor ( var i = 0; i < focus_img_containers.length; i++ ) {\n  \t\tvar img_container = focus_img_containers[i];\n\t\timg = img_container.getElementsByClassName('image--main')[0];\n\t\tif ( ! img.classList.contains( 'lazy' ) ) {\n\t\t\t//console.log('no lazy image detected');\n\t\t\tdoFocusTranslate( img );\n\t\t}\n\t}\n\n\tvar floated_elements = document.querySelectorAll('.floated');\n\tfor (var j = 0; j < floated_elements.length; j++ ) {\n\t\tvar equal_element = floated_elements[j].nextElementSibling,\n\t\th = floated_elements[j].offsetHeight,\n\t\tequal_h = equal_element.offsetHeight;\n\t\t// console.log( floated_elements[j] );\n\t\t// console.log( equal_element );\n\t\t// console.log( 'neighbour: ' + equal_h + ' px');\n\t\tif ( h > equal_h ) {\n\t\t\tequal_element.style.height = h + 'px';\n\t\t}\n\t}\n\n/* \tjQuery('#gform_6 #input_6_7').change(function(){\n    var attendees = jQuery(this).val();\n    gfRepeater_setRepeater(6, 1, attendees);\n}); */\n\n\tjQuery('.translatedparagraph--has_translations').each( function() {\n\t\tvar select = jQuery( this ).find('.translation-select');\n\t\tselect.on('change', function() {\n\t\t\tvar lang = 'paragraph--' + this.value;\n\t\t\tfunction doLanguageSwitch( lang ) {\n\t\t\t\treturn function( index, element) {\n\t\t\t\t\tjQuery( this ).removeClass('show');\n\t\t\t\t\tif ( jQuery( this ).hasClass( lang ) ) {\n\t\t\t\t\t\tjQuery( this ).addClass('show');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tvar wrapper = jQuery( this ).parent().parent('.translatedparagraph--has_translations');\n\t\t\tparagraphs = wrapper.children('.translatedparagraph__paragraph');\n\t\t\tparagraphs.each( doLanguageSwitch( lang ) );\n\t\t});\n\t});\n\n\tjQuery('.image--main').each( function() {\n\t\tconsole.log( jQuery(this).height() );\n\t});\n\n    // Remove empty P tags created by WP inside of Accordion and Orbit\n    jQuery('.accordion p:empty, .orbit p:empty').remove();\n\n\t // Makes sure last grid item floats left\n\tjQuery('.archive__grid .columns', 'relatedgrid .columns').last().addClass( 'end' );\n\n\t// Adds Flex Video to YouTube and Vimeo Embeds\n\tjQuery('iframe[src*=\"youtube.com\"], iframe[src*=\"vimeo.com\"]').each(function() {\n\t\tif ( jQuery(this).innerWidth() / jQuery(this).innerHeight() > 1.5 ) {\n\t\t  jQuery(this).wrap(\"<div class='widescreen flex-video'/>\");\n\t\t} else {\n\t\t  jQuery(this).wrap(\"<div class='flex-video'/>\");\n\t\t}\n\t});\n\n  // Archive functions\n\tif ( jQuery('body').hasClass('archive') ) {\n\t\tvar $archiveGrid = jQuery('.archive__grid').masonry({\n\t\t  \"itemSelector\": \".archive__grid__griditem\"\n\t\t});\n\n\t\tjQuery('.archive__filter__button').each(function() {\n\t\t\tjQuery(this).on('click', function() {\n\t\t\t\tvar tax = jQuery(this).data('tax'),\n\t\t\t\ttermList = jQuery(this).parent().find('.archive__filter__datalist'),\n\t\t\t\tterm = termList.val();\n\t\t\t\tif ( term !== null && term !== undefined && term !== '' ) {\n\t\t\t\t\tvar termOption = jQuery('.archive__filter').find('.archive__filter__tax-datalist[data-tax=' + tax + ']').find('option[value=\"' + term + '\"]:not(:selected)');\n\t\t\t\t\tif ( termOption.length ) {\n\t\t\t\t\t\tvar termData = termOption.data();\n\t\t\t\t\t\ttermData.name = term;\n\t\t\t\t\t\ttermData.tax = tax;\n\t\t\t\t\t\t// Pass term option element object, so it can be removed on click\n\t\t\t\t\t\tvar tag = getQueryTag(termData, termOption),\n\t\t\t\t\t\ttagBox = jQuery('.archive__filter__query-tags ul');\n\t\t\t\t\t\ttagBox.empty().append( tag );\n\t\t\t\t\t\ttermOption.attr('selected','selected');\n\t\t\t\t\t\tfetchCollaborations();\n\t\t\t\t\t}\n\t\t\t\t\ttermList.val('');\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\n\t\tjQuery('.archive__button').on('click',function( e ) {\n\t\t\te.preventDefault();\n\t\t\tvar $moreButton = jQuery(this),\n\t\t\tpaged = $moreButton.data('paged'),\n\t\t\tmax_num_pages = $moreButton.data('max_num_pages'),\n\t\t\tobject = $moreButton.data('object'),\n\t\t\tposts_per_page = $moreButton.data('posts_per_page'),\n\t\t\ttax_query = $moreButton.data('tax_query');\n\t\t\tif ( tax_query ) {\n\t\t\t\trestBase = '/wp-json/exchange/v1/' + object + '/' + tax_query;\n\t\t\t\tfilters = '?page=' + ( paged + 2 ) + '&posts_per_page=' + posts_per_page;\n\t\t\t} else {\n\t\t\t\trestBase = '/wp-json/wp/v2/' + object;\n\t\t\t\tfilters = '?filter[post_status]=publish&filter[posts_per_page]=' + posts_per_page + '&page=' + ( paged + 2 ) + '&filter[orderby]=date&filter[order]=desc';\n\t\t\t}\n\t\t\tvar restUrl = baseUrl + restBase + filters;\n\t\t\tif ( ( paged + 1 ) < max_num_pages ) {\n\t\t\t\tjQuery.ajax({\n\t\t\t\t\turl: restUrl,\n\t\t\t\t\tmethod: 'GET',\n\t\t\t\t\tcrossDomain: true,\n\t\t\t\t\tcontentType: 'application/json',\n\t\t\t\t\tsuccess: function( data, status, request ) {\n\t\t\t\t\t\t// console.log( 'X-WP-Total: ' + request.getResponseHeader('X-WP-Total') );\n\t\t\t\t\t\t// console.log( 'X-WP-TotalPages: ' + request.getResponseHeader('X-WP-TotalPages') );\n\t\t\t\t\t\tconsole.log( restUrl );\n\t\t\t\t\t\tvar pagelength = data.length,\n\t\t\t\t\t\t\titems = '';\n\t\t\t\t\t\tfor ( var i = 0; i < pagelength; i++ ) {\n\t\t\t\t\t\t\titems = items + data[i].exchange_basics.griditem;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar $items = jQuery( items );\n\t\t\t\t\t\t$archiveGrid.append( $items ).masonry( 'appended',$items ).masonry();\n\t\t\t\t\t\tpaged = paged + 1;\n\t\t\t\t\t\t$moreButton.data('paged', paged );\n\t\t\t\t\t\tif ( paged + 1 == max_num_pages ) {\n\t\t\t\t\t\t\t$moreButton.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\terror: function( error ) {\n\t\t\t\t\t\tconsole.log( error );\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\tif ( jQuery('body').hasClass('post-type-archive-collaboration') ) {\n\n\t\tvar baseMapUrl = 'https://api.mapbox.com/styles/v1/retrorism/cio2pv2ft001ybvm8qb4da6f9/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoicmV0cm9yaXNtIiwiYSI6IlhRWTE0d2cifQ.-Wi_jReZU4Wz_owPnVZDwQ',\n\t\tbase = L.tileLayer(baseMapUrl, {subdomains: '1234'});\n\t\tmap = L.map('leaflet-archive-map',{\n\t\t\tlayers: [base],\n\t\t\tmaxZoom: 20,\n\t\t\tminZoom: 0,\n\t\t\tzoomControl: 1,\n\t\t\tscrollWheelZoom: 0,\n\t\t\tattributionControl: false\n\t\t}).setView([48, 16], 4);\n\t\tvar attControl = L.control.attribution({prefix:false}).addTo(map);attControl.addAttribution('Tiles Courtesy of <a href=\"http://www.mapbox.com/\" target=\"_blank\">MapBox</a> © <a href=\"http://www.openstreetmap.org/\">OpenStreetMap</a> contributors');\n\t\tfetchCollaborations();\n\t\t// route = createRoute([[41.0082376,28.9783589],[45.8609375,25.7885796],[45.8609375,25.7885796]],[[[41.0082376,28.9783589],[45.8609375,25.7885796]]],[\"Istanbul\",\"Sfantu Gheorghe\",\"\"]);\n\t\t// route.bindPopup('<a class=\\\"\\\" href=\\\"http://localhost/tandem/collaborations/looking-forat-the-invisible/\\\" title=\\\"Navigate to Looking For/At The Invisible\\\">Looking For/At The Invisible</a>');\n\t\t// route.addTo( map );\n\t\t// map.fitBounds( route.getBounds().pad(0.033) );\n\t\t// route.snakeIn();\n\t}\n\n\n});\n","jQuery(document).foundation();"],"sourceRoot":"/source/"}