{"version":3,"sources":["exchange-functions.js","exchange-variables.js","init-foundation.js","wp-foundation.js"],"names":["handleScroll","previousScroll","pageYOffset","jQuery","window","scroll","currentScroll","this","scrollTop","removeClass","addClass","getArchiveMap","undefined","Exchange","PluginExtensions","LMP","maps","hashedMap","hasOwnProperty","archiveMap","hash","slice","getUrlVars","vars","hashes","location","href","indexOf","split","i","length","push","getFocusTranslate","img_placeholder","img","img_data","parentNode","dataset","h","clientHeight","container_h","offsetHeight","px_translate","focus_h","max_translate","translate","doFocusTranslate","translateNeg","transform","setAttribute","processFloatedElements","floated_elements","document","querySelectorAll","ii","equal_element","nextElementSibling","equal_h","style","height","addFacetMarker","facet","accordion","find","hasClass","html","removeFacetMarker","processFacetsUI","facetHeader","facetString","facetList","count","facets","archiveUrl","protocol","host","pathname","join","items","FWP","settings","selected_facets","search","name","terms","val","taxFacet","tax","facetLabel","labels","slug","facetUrl","encodeURIComponent","vacetUrl","toLowerCase","loaded","pager","total_rows","replace","$grid","masonryOptions","percentPosition","columnWidth","gutter","itemSelector","masonryIsActive","foundation","$","ready","$body","wp","hooks","addFilter","resp","params","is_load_more","append","each","on","e","target","preventDefault","id","data","targetjQ","prop","selection","grid","prToken","pr","action","update_id","prid","token","security","remove","ajax","url","exchange_ajax","ajax_url","method","done","response","removeProp","select","doLanguageSwitch","lang","index","element","value","wrapper","parent","paragraphs","children","map","fitBounds","clusterLayer","getBounds","masonry","invalidateSize","last","innerWidth","innerHeight","wrap","paged","parseInt","page","soft_refresh","refresh","inputVal","trim","keyEvent","Event","which","keyCode","facetTag","facetType","facetValue","first","facetIndex","splice","show","total_pages","hide","animate","offset","bottom","allObjects","map_polylines","matches","matchedPolylines","filter","p","includes","refreshObjects","renderObjects"],"mappings":"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","file":"scripts.min.js","sourcesContent":["function handleScroll() {\n\tvar previousScroll = pageYOffset;\n\tjQuery(window).scroll( function(){\n\t\tvar currentScroll = jQuery(this).scrollTop();\n\t\tpreviousScroll = currentScroll;\n\t\tif ( pageYOffset < 100 ) {\n\t\t\tjQuery('.breadcrumbs-bar').removeClass('scrolled');\n\t\t} else {\n\t\t\tjQuery('.breadcrumbs-bar').addClass('scrolled');\n\t\t}\n\n\t} );\n}\n\nfunction getArchiveMap() {\n\tif ( undefined === Exchange || undefined === Exchange.PluginExtensions || undefined === Exchange.PluginExtensions.LMP || undefined === Exchange.PluginExtensions.LMP.maps ) {\n\t\treturn;\n\t}\n    for ( var hashedMap in Exchange.PluginExtensions.LMP.maps ) {\n        if ( Exchange.PluginExtensions.LMP.maps.hasOwnProperty( hashedMap ) ) {\n            archiveMap = Exchange.PluginExtensions.LMP.maps[hashedMap];\n            archiveMap.hash = hashedMap.slice( 4 );\n            break;\n        }\n    }\n    if ( archiveMap ) {\n\t\treturn archiveMap;\n    }\n}\n\nfunction getUrlVars() {\n    var vars = [], \n    \thash,\n    \thashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');\n    for ( var i = 0; i < hashes.length; i++ ) {\n        hash = hashes[i].split('=');\n        vars.push(hash[0]);\n        vars[hash[0]] = hash[1];\n    }\n    return vars;\n}\n\nfunction getFocusTranslate( img_placeholder, img ) {\n\timg_data = img_placeholder.parentNode.dataset;\n\tif ( ! img_data ) {\n\t\treturn false;\n\t}\n\tvar h = img.clientHeight,\n\t\tcontainer_h =  img_placeholder.offsetHeight,\n\t\tpx_translate = ( img_data.focus_h * h ) - ( container_h / 2 ),\n\t\tmax_translate = ( ( h - container_h ) / h ) * 100,\n\t\ttranslate = ( px_translate / h ) * 100;\n\n\t//If the center of the container is below the focus point, don't move.\n\t//Or: if the translation is downwards, don't move (we're working from top).\n\tif ( px_translate < 0 || translate < 0 ) {\n\t\treturn false;\n\t}\n\n\treturn translate > max_translate ? max_translate : translate;\n}\n\nfunction doFocusTranslate( img ) {\n\tvar img_placeholder = img.parentNode,\n\t\ttranslate = getFocusTranslate( img_placeholder, img );\n\t// Keep the negative, add minus if necessary\n\tif ( translate ) {\n\t\tvar translateNeg = translate > 0 ? -1 * translate : translate,\n\t\ttransform = 'transform: translateY(' + translateNeg + '%);';\n\t\timg.setAttribute( 'style', transform );\n\t}\n}\n\nfunction processFloatedElements() {\n\tvar floated_elements = document.querySelectorAll('.floated');\n\tif ( ! floated_elements.length > 0 ) {\n\t\treturn;\n\t}\n\tfor (var ii = 0; ii < floated_elements.length; ii++ ) {\n\t\tvar equal_element = floated_elements[ii].nextElementSibling,\n\t\th = floated_elements[ii].offsetHeight,\n\t\tequal_h = equal_element.offsetHeight;\n\t\tif ( h > equal_h ) {\n\t\t\tequal_element.style.height = h + 'px';\n\t\t}\n\t}\n}\n\nfunction addFacetMarker( facet ) {\n\tvar accordion = jQuery('.accordion').find('li[data-facet-type=' + facet + ']');\n\tif ( ! accordion.hasClass('is-active') ) {\n\t\taccordion.find('span.filter-count').html(' &#x2714');\n\t}\n}\n\nfunction removeFacetMarker( facet ) {\n\tvar accordion = jQuery('.accordion').find('li[data-facet-type=' + facet + ']');\n\taccordion.find('span.filter-count').html('');\n}\n\nfunction processFacetsUI() {\n\t// Define variables\n\tvar facetHeader = '',\n\t\tfacetString = '',\n\t\tfacetList = {\n\t\t\t'count': 0,\n\t\t\t'facets': []\n\t\t},\n\t\tarchiveUrl = [location.protocol, '//', location.host, location.pathname].join(''),\n\t\titems = ' results';\n\n\t// If there are no search facets and no selected facets, return;\n\tif ( undefined === FWP.facets && undefined === FWP.settings.selected_facets ) {\n\t\treturn;\n\t}\n\n\t// Track and process search field data\n\tif ( undefined !== FWP.facets ) {\n\t\tif ( FWP.facets.search.length > 0 ) {\n\t\t\tfacetList.facets.push( {\n\t\t\t\t'name': 'search',\n\t\t\t\t'terms': ['\"' + FWP.facets.search + '\"'],\n\t\t\t} );\n\t\t\tjQuery('.facetwp-search').val( FWP.facets.search );\n\t\t\tfacetList.count++;\n\t\t\tfacetString += '<ul class=\"term-list\" data-facet-type=\"search\">';\n\t\t\tfacetString += '<li class=\"term tag search\">\"' + FWP.facets.search + '\" <a href=\"#\" title=\"Remove this search query\" class=\"remove-facet-value\">&#10005;</a></li>';\n\t\t\tfacetString += '</ul>';\n\t\t}\n\t\tfor ( var taxFacet in FWP.facets ) {\n\t\t\tif ( FWP.facets[taxFacet].length === 0 ) {\n\t\t\t\tremoveFacetMarker( taxFacet );\n\t\t\t}\n\t\t}\n\t}\n\n\t// Use selected_facets variable to create tag lists with pretty names\n\tif ( undefined !== FWP.settings.selected_facets ) {\n\t\tfor ( var facet in FWP.settings.selected_facets ) {\n\t\t\tvar tax = FWP.settings.selected_facets[facet];\n\t\t\tif ( tax.length > 0 ) {\n\t\t\t\taddFacetMarker( facet );\n\t\t\t\tfacetList.facets.push( {\n\t\t\t\t\t'name': facet,\n\t\t\t\t\t'terms': tax,\n\t\t\t\t} );\n\t\t\t\tfacetLabel = ( undefined !== FWP.settings.labels[facet] ) ? FWP.settings.labels[facet] : '';\n\t\t\t\tif ( facetList.count < 6 ) {\n\t\t\t\t\tfacetString += '<ul class=\"term-list\" data-facet-type=\"' + facet + '\">';\n\t\t\t\t}\n\t\t\t\tfor ( var i = 0; tax.length > i && tax.length < 6; i++ ) {\n\t\t\t\t\tif ( FWP.facets[facet].indexOf(tax[i].slug) > -1 ) {\n\t\t\t\t\t\tfacetList.count++;\n\t\t\t\t\t\tif ( facetList.count < 6 ) {\n\t\t\t\t\t\t\tvar facetUrl = archiveUrl + '?fwp_' + facet + '=' + encodeURIComponent( tax[i].slug );\n\t\t\t\t\t\t\tvacetUrl = '#'\n\t\t\t\t\t\t\t//facetString += '<li><a href=\"' + facetUrl + '\" class=\"tag ' + facet + '\" title=\"' + facetLabel + ': ' + tax[i].name + '\">' + tax[i].name + '</a></li>';\n\t\t\t\t\t\t\tfacetString += '<li class=\"tag ' + facet + '\" data-facet-value=\"' + tax[i].slug + '\">' + tax[i].name + ' <a href=\"' + facetUrl + '\" class=\"remove-facet-value\" title=\"Remove this ' + facetLabel.toLowerCase() + ': ' + tax[i].name + '\">&#10005;</a></li>';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ( facetList.count < 6 ) {\n\t\t\t\t\tfacetString += '</ul>';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif ( facetList.count > 5 ) {\n\t\t\tfacetString += facetList.count === 6 ? '<span class=\"other-terms\"> and 1 other tag</span>' : '<span class=\"other-terms\">and ' + ( facetList.count - 5 ) + ' other tags.</span>';\n\t\t}\n\t}\n\n\t// Update the header and help text\n\tif ( ! FWP.loaded ) {\n\t\tfacetHeader = '<h5>Loading...</h5>';\n\t}\n\tif ( undefined !== FWP.settings.pager && FWP.settings.pager.total_rows >= 0 ) {\n\t\tif ( FWP.settings.pager.total_rows === 0 ) {\n\t\t\tfacetHeader = '<h5>No' + items + ' found</h5>';\n\t\t} else {\n\t\t\titems = FWP.settings.pager.total_rows === 1 ? ' result' : ' results';\n\t\t\tif ( jQuery('body').hasClass('post-type-archive-story') ) {\n\t\t\t\titems = FWP.settings.pager.total_rows === 1 ? ' story' : ' stories';\n\t\t\t}\n\t\t\tif ( jQuery('body').hasClass('post-type-archive-collaboration') ) {\n\t\t\t\titems = FWP.settings.pager.total_rows === 1 ? ' collaboration' : ' collaborations';\n\t\t\t} \n\t\t\tfacetHeader = '<h5>Showing ' + FWP.settings.pager.total_rows + items + '</h5>';\n\t\t}\n\t\tif ( facetList.count === 0 ) {\n\t\t\tfacetHeader +='<small class=\"no-terms\">This is everything! You can use filters <span class=\"hide-for-small-only\">to the left </span>to refine the results.</small>';\n\t\t}\n\t}\n\tif ( facetList.count > 0 ) {\n\t\tjQuery('#main').addClass('facets-active');\n\t\tjQuery('.archive__active-facet-summary').html( facetHeader.replace('</h5>', ' for:</h5>') + facetString );\n\t} else {\n\t\tjQuery('.archive__active-facet-summary').html( facetHeader );\n\t}\n}","var archiveMap,\n\t$grid,\n\tmasonryOptions = { \n\t\t\"percentPosition\": true, \n\t\t\"columnWidth\": \".masonry__grid-sizer\", \n\t\t\"gutter\": \".masonry__gutter-sizer\", \n\t\t\"itemSelector\": \".archive__grid__griditem\"\n\t},\n\tmasonryIsActive = false;","jQuery(document).foundation();","( function( $ ){\n\n\t$( document ).ready( function() {\n\n\t\tprocessFloatedElements();\n\n\t\tvar $body = $('body');\n\n\t\tif ( $grid === undefined ) {\n\t\t\t$grid = $('.archive__grid__masonry');\n\t\t}\n\n\t\t// Load more button for FWP\n\t\tif ( 'object' == typeof FWP ) { \n\t\t    wp.hooks.addFilter('facetwp/template_html', function(resp, params) {\n\t\t        if ( FWP.is_load_more ) {\n\t\t            FWP.is_load_more = false;\n\t\t            $('.facetwp-template').append( params.html );\n\t\t            return true;\n\t\t        }\n\t\t        return resp;\n\t\t    });\n\t\t}\n\n\t\t// Proces images that have a focus property\n\t\t$('.focus').each( function() {\n\t\t\tvar img = $(this).find('.image--main');\n\t\t\timg.on('load', function( e ){\n\t\t\t\tdoFocusTranslate(e.target);\n\t\t\t});\n\t\t});\n\t\t\n\t\t// Open gallery when clicking an image\n\t\t$( 'a[data-open=story__modal--gallery]' ).on( 'click', function( e ) {\n\t\t\te.preventDefault();\n\t\t\tvar id = $(this).data('img_id'),\n\t\t\ttargetjQ = $('#story__modal--gallery').find('#' + id);\n\t\t\t$('.orbit').foundation( 'changeSlide', true, targetjQ );\n\t\t});\n\n\t\t// Token form submission\n\t\t$( '#token-form__submit' ).on( 'click', function( e ) {\n\t\t\te.preventDefault();\n\t\t\t$(this).prop( 'disabled',true );\n\t\t\tvar selection = $( '.token-form__collab-select option:selected' ),\n\t\t\tgrid = $('.grid--form-options'),\n\t\t\tprToken = getUrlVars().pr;\n\t\t\tif ( undefined !== selection ) {\n\t\t\t\tvar data = {\n\t\t\t\t\taction: 'exchange_token_form',\n\t\t\t\t\tupdate_id : selection.val(),\n\t\t\t\t\tprid : selection.data('programme-round'),\n\t\t\t\t\ttoken : prToken,\n\t\t\t\t\tsecurity : $( '.token-form__nonce' ).val()\n\t\t\t\t};\n\t\t\t\t$('.loader-pointer').remove();\n\t\t\t\t$('.loader-wrapper').addClass('go');\n\t\t\t\tgrid.html('');\n\t\t\t\t$.ajax( {\n\t\t\t\t\t'url':    exchange_ajax.ajax_url,\n\t\t\t\t\t'method': 'POST',\n\t\t\t\t\t'data':   data\n\t\t\t\t} ).done( function ( response ) {\n\t\t\t\t\tgrid.html( response );\n\t\t\t\t\t$('.loader-wrapper').removeClass('go');\n\t\t\t\t\t$(this).removeProp('disabled');\n\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\t// Switch for translated paragraphs\n\t\t$('.translatedparagraph--has_translations').each( function() {\n\t\t\tvar select = $( this ).find('.translation-select');\n\t\t\tselect.on('change', function() {\n\t\t\t\tvar lang = 'paragraph--' + this.value;\n\t\t\t\tfunction doLanguageSwitch( lang ) {\n\t\t\t\t\treturn function( index, element) {\n\t\t\t\t\t\t$( this ).removeClass('show');\n\t\t\t\t\t\tif ( $( this ).hasClass( lang ) ) {\n\t\t\t\t\t\t\t$( this ).addClass('show');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvar wrapper = $( this ).parent().parent('.translatedparagraph--has_translations');\n\t\t\t\tparagraphs = wrapper.children('.translatedparagraph__paragraph');\n\t\t\t\tparagraphs.each( doLanguageSwitch( lang ) );\n\t\t\t});\n\t\t});\n\n\t\t// Scroll-handler for breadcrumbs.\n\t\tif ( $body.hasClass('single') || $body.hasClass('page-child') ) {\n\t\t\t$('#main').on('scrollme.zf.trigger', handleScroll);\n\t\t}\n\n\t\t// Archive functions (get map, activate masonry).\n\t\tif ( $body.hasClass( 'archive' ) || $body.hasClass( 'page-template-archive' ) || $body.hasClass( 'search' ) || $('.featuredgrid__masonry').length === 1 ) {\n\t\t\tif ( $body.hasClass( 'post-type-archive-participant') ) {\n\t\t\t\tif ( archiveMap === undefined ) {\n\t\t\t\t\tarchiveMap = getArchiveMap();\n\t\t\t\t}\n\t\t\t\tif ( archiveMap ) {\t\t\t\t\n\t\t\t\t\tarchiveMap.map.fitBounds( archiveMap.clusterLayer.getBounds() );\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( $grid !== undefined ) {\n\t\t\t\t$grid.masonry( masonryOptions ); // re-initialize\n\t\t\t\tmasonryIsActive = true;\n\t\t\t}\n\t\t}\n\n\t\t// Tab switcher\n    \t$('#facet-tabs').on( 'change.zf.tabs', function() {\n\t\t\tif ( archiveMap === undefined ) {\n\t\t\t\tarchiveMap = getArchiveMap();\n\t\t\t}\n\t\t\tif ( archiveMap.map !== undefined ) {\n\t\t\t\tarchiveMap.map.invalidateSize().fitBounds( archiveMap.clusterLayer.getBounds() );\n\t\t\t}\n\t\t\tif ( $grid !== undefined ) {\n\t\t\t\t$grid.masonry( masonryOptions ); // re-initialize\n\t\t\t\tmasonryIsActive = true;\n\t\t\t}\n\t\t});\n\n    \t// Facet switcher\n\t\t$('#facet-switch').on( 'click', function() {\n\t\t\t('#main').foundation('toggle');\n\t\t});\n\n\t\t// Remove empty P tags created by WP inside of Accordion and Orbit\n\t\t$('.accordion p:empty, .orbit p:empty').remove();\n\n\t\t// Makes sure last grid item floats left\n\t\t$('.archive__grid .columns', 'relatedgrid .columns').last().addClass( 'end' );\n\n\t\t// Adds Flex Video to YouTube and Vimeo Embeds\n\t\t$('iframe[src*=\"youtube.com\"], iframe[src*=\"vimeo.com\"]').each( function() {\n\t\t\tif ( $(this).innerWidth() / $(this).innerHeight() > 1.5 ) {\n\t\t\t\t$(this).wrap(\"<div class='widescreen flex-video'/>\");\n\t\t\t} else {\n\t\t\t\t$(this).wrap(\"<div class='flex-video'/>\");\n\t\t\t}\n\t\t});\n\t});\n\n\t// Handle Load More click ( on archive pages );\n\t$(document).on('click', '.fwp-load-more', function() {\n        $('.fwp-load-more').html('Loading...');\n        FWP.is_load_more = true;\n        FWP.paged = parseInt( FWP.settings.pager.page ) + 1;\n        FWP.soft_refresh = true;\n        FWP.refresh();\n    });\n\n\t// Handle search click ( on archive pages );\n\t$(document).on('click', '.facetwp-facet-search .facetwp-btn--exchange', function( e ) {\n\t\te.preventDefault();\n\t\tvar inputVal = $('.facetwp-search').val().trim(),\n\t\t\tkeyEvent = $.Event('keydown');\n\t\tkeyEvent.which = 50;\n\t\tkeyEvent.keyCode = 50;\n\t\tFWP.facets.search = inputVal;\n\t\tFWP.refresh();\n\t} );\n\n\t// Handle remove-facet click ( on archive pages );\n\t$(document).on('click', '.remove-facet-value', function( e ) {\n\t\te.preventDefault();\n\t\tvar facetTag = $(this).parent();\n\t\t\tfacetType = facetTag.parent().data('facet-type'),\n\t\t\tfacetValue = facetTag.data('facet-value');\n\t\tif ( 'search' === facetType ) {\n\t\t\tjQuery('.facetwp-search').val('');\n\t\t\tjQuery('ul[data-facet-type=\"search\"]').first().remove();\n\t\t} else {\n\t\t\tvar facetIndex = FWP.facets[facetType].indexOf(facetValue);\n\t\t\tif ( facetIndex > -1 ) {\n\t\t\t\tFWP.facets[facetType].splice(facetIndex, 1);\n\t\t\t\t$('div[data-value=\"' + facetValue + '\"]').first().removeClass('checked');\n\t\t\t}\n\t\t}\n\t\tFWP.refresh();\n\t} );\n\n})(jQuery);\n\n( function( $ ){\n\t$(document).on('facetwp-loaded', function() {\n\t\tprocessFacetsUI();\n\t\t$('.no-terms').show();\n\n\t\t// Destroy and re-initialise grid.\n\t\t$grid = $('.archive__grid__masonry');\n\t\tif ( masonryIsActive ) {\n\t\t    $grid.masonry('destroy'); // destroy\n\t\t}\n\t\t$grid.masonry( masonryOptions ); // re-initialise\n\t\tmasonryIsActive = true;\n\n\t\t// Update Load-more button.\n\t\tif ( FWP.settings.pager.page < FWP.settings.pager.total_pages ) {\n\t\t\t$('.fwp-load-more').html('Load more');\n\t\t    $('.fwp-load-more').show();\n\t\t} else {\n\t\t    $('.fwp-load-more').hide();\n\t\t}\n\n\t\t// Scroll down to display new results\n\t\tif ( FWP.settings.pager.page > 1 ) {\n\t\t\t$('html, body').animate( {\n\t            scrollTop: $('.archive__grid__masonry').offset().bottom\n\t        }, 1000);\n\t    }\n\t\t\n\t\t// Look for leaflet map.\n\t\tarchiveMap = getArchiveMap();\n\t\tif ( archiveMap === undefined ) {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\t// Map functions (will not run when archiveMap is undefined);\n\t\tvar allObjects = window['leaflet_objects_' + archiveMap.hash];\n\t\t\n\t\tif ( allObjects === undefined || allObjects.map_polylines.length === 0 || FWP.settings.matches.length === 0 ) {\n\t\t\treturn;\n\t\t}\n\t\tif ( allObjects.map_polylines.length > 0 && FWP.settings.matches.length > 0 ) {\n\t\t\tvar matchedPolylines = allObjects.map_polylines.filter( function( p ) {\n\t\t\t\tif (  FWP.settings.matches.includes( p.id ) ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif ( matchedPolylines.length > 0 ) {\n\t\t\t\tvar refreshObjects = {\n\t\t\t\t\tmap_polylines : matchedPolylines\n\t\t\t\t};\n\t\t\t\tarchiveMap.renderObjects( refreshObjects );\n\t\t\t}\n\t\t}\n\t});\n})(jQuery);\n\n( function( $ ){\n    $(document).on('facetwp-refresh', function() {\n    \tjQuery('.archive__active-facet-summary').html('<h5>Loading...</h5>');\n        if ( ! FWP.loaded ) {\n            FWP.paged = 1;\n        }\n    });\n})(jQuery);\n"],"sourceRoot":"/source/"}