{"version":3,"sources":["wp-foundation.js","init-foundation.js"],"names":["handleScroll","previousScroll","pageYOffset","jQuery","window","scroll","currentScroll","this","scrollTop","removeClass","addClass","getArchiveMap","undefined","Exchange","PluginExtensions","LMP","maps","hashedMap","hasOwnProperty","archiveMap","hash","slice","getUrlVars","vars","hashes","location","href","indexOf","split","i","length","push","getFocusTranslate","img_placeholder","img","img_data","parentNode","dataset","h","clientHeight","container_h","offsetHeight","px_translate","focus_h","max_translate","translate","doFocusTranslate","translateNeg","transform","setAttribute","openFacets","facetsActive","facetList","each","parent","facet","find","content","children","boxes","parentFilterCount","facetTax","clone","remove","end","text","trim","name","terms","hasClass","lastItem","html","facetString","map","tax","document","foundation","$grid","masonryOptions","percentPosition","columnWidth","gutter","itemSelector","masonryIsActive","$","ready","$body","FWP","wp","hooks","addFilter","resp","params","is_load_more","append","console","log","on","e","target","floated_elements","querySelectorAll","ii","equal_element","nextElementSibling","equal_h","style","height","preventDefault","id","data","targetjQ","prop","selection","grid","prToken","pr","action","update_id","val","prid","token","security","ajax","url","exchange_ajax","ajax_url","method","done","response","removeProp","select","doLanguageSwitch","lang","index","element","value","wrapper","paragraphs","fitBounds","clusterLayer","getBounds","masonry","invalidateSize","last","innerWidth","innerHeight","wrap","paged","parseInt","settings","pager","page","soft_refresh","refresh","total_pages","show","hide","animate","offset","bottom","allObjects","map_polylines","matches","matchedPolylines","filter","p","includes","refreshObjects","renderObjects","loaded"],"mappings":"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","file":"scripts.min.js","sourcesContent":["var archiveMap,\n$grid;\n\nfunction handleScroll() {\n\tvar previousScroll = pageYOffset;\n\tjQuery(window).scroll( function(){\n\t\tvar currentScroll = jQuery(this).scrollTop();\n\t\tpreviousScroll = currentScroll;\n\t\tif ( pageYOffset < 100 ) {\n\t\t\tjQuery('.breadcrumbs-bar').removeClass('scrolled');\n\t\t} else {\n\t\t\tjQuery('.breadcrumbs-bar').addClass('scrolled');\n\t\t}\n\n\t});\n}\n\nfunction getArchiveMap() {\n\tif ( undefined === Exchange || undefined === Exchange.PluginExtensions || undefined === Exchange.PluginExtensions.LMP || undefined === Exchange.PluginExtensions.LMP.maps ) {\n\t\treturn;\n\t}\n    for ( var hashedMap in Exchange.PluginExtensions.LMP.maps ) {\n        if ( Exchange.PluginExtensions.LMP.maps.hasOwnProperty( hashedMap ) ) {\n            archiveMap = Exchange.PluginExtensions.LMP.maps[hashedMap];\n            archiveMap.hash = hashedMap.slice( 4 );\n            break;\n        }\n    }\n    if ( archiveMap ) {\n        return archiveMap;\n    }\n}\n\nfunction getUrlVars() {\n    var vars = [], hash;\n    var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');\n    for( var i = 0; i < hashes.length; i++ ) {\n        hash = hashes[i].split('=');\n        vars.push(hash[0]);\n        vars[hash[0]] = hash[1];\n    }\n    return vars;\n}\n\nfunction getFocusTranslate( img_placeholder, img ) {\n\timg_data = img_placeholder.parentNode.dataset;\n\tif ( ! img_data ) {\n\t\treturn false;\n\t}\n\tvar h = img.clientHeight,\n\tcontainer_h =  img_placeholder.offsetHeight,\n\tpx_translate = ( img_data.focus_h * h ) - ( container_h / 2 ),\n\tmax_translate = ( ( h - container_h ) / h ) * 100,\n\ttranslate = ( px_translate / h ) * 100;\n\n\t//If the center of the container is below the focus point, don't move.\n\t//Or: if the translation is downwards, don't move (we're working from top).\n\tif ( px_translate < 0 || translate < 0 ) {\n\t\treturn false;\n\t}\n\n\tif ( translate > max_translate ) {\n\t\treturn max_translate;\n\t} else {\n\t\treturn translate;\n\t}\n}\n\nfunction doFocusTranslate( img ) {\n\tvar img_placeholder = img.parentNode;\n\ttranslate = getFocusTranslate( img_placeholder, img );\n\t// Keep the negative, add minus if necessary\n\tif ( translate ) {\n\t\tvar translateNeg = translate > 0 ? -1 * translate : translate,\n\t\ttransform = 'transform: translateY(' + translateNeg + '%);';\n\t\timg.setAttribute( 'style', transform );\n\t}\n}\n\nfunction openFacets() {\n\tvar facetsActive = false;\n\tvar facetList = [];\n\tjQuery('.accordion-item').each( function() {\n\t\tvar parent = jQuery( this ),\n\t\t\tfacet = parent.find('a.accordion-title'),\n\t\t\tcontent = parent.children('.accordion-content'),\n\t\t\tboxes = content.children().children('.facetwp-checkbox'),\n\t\t\tparentFilterCount = 0;\n\t\t\tif ( facet ) {\n\t\t\t\tvar facetTax = facet.clone().children().remove().end().text().trim();\n\t\t\t\tfacetList.push( {\n\t\t\t\t\t'name' : facetTax, \n\t\t\t\t\t'terms' : [] \n\t\t\t\t} );\n\t\t\t\tboxes.each( function() {\n\t\t\t\t\tif ( jQuery(this).hasClass('checked') ) {\n\t\t\t\t\t\tfacetsActive = true;\n\t\t\t\t\t\tparent.addClass('.is-active');\n\t\t\t\t\t\tparentFilterCount++;\n\t\t\t\t\t\tvar lastItem = facetList[ facetList.length - 1 ];\n\t\t\t\t\t\tlastItem.terms.push( jQuery(this).clone().children().remove().end().text().trim() );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\tparent.find('span.filter-count').html('');\n\t\tif ( parentFilterCount > 0 ) {\n\t\t\tparent.find('span.filter-count').html(' (' + parentFilterCount + ')' );\n\t\t}\n\t} );\n\tif ( facetsActive ) {\n\t\tjQuery('#main').addClass('facets-active');\n\t}\n\tif ( facetList ) {\n\t\tvar facetString = '';\n\t\tif ( facetsActive ) {\n\t\t\tfacetString += '<h4>Showing results for:</h4>';\n\t\t}\n\t\tfacetList.map( function( tax ) {\n\t\t\tif ( tax.terms.length > 0 ) {\n\t\t\t\t//facetString += '<span class=\"facet-list-title\">' + tax.name + ': </span>';\n\t\t\t\tfacetString += '<ul class=\"term-list\" data-value=\"' + tax.name + '\">';\n\t\t\t\tfor ( var i = 0; tax.terms.length > i; i++ ) {\n\t\t\t\t\tfacetString += '<li class=\"term\" title=\"' + tax.name + ': ' + tax.terms[i] + '\">' + tax.terms[i] + '</li>'\n\t\t\t\t}\n\t\t\t\tfacetString += '</ul>';\n\t\t\t}\n\t\t} );\n\t\tjQuery('.archive__active-facet-summary').html( facetString );\n\t}\n}\n\nvar masonryOptions = { \n\t\t\t\"percentPosition\": true, \n\t\t\t\"columnWidth\": \".masonry__grid-sizer\", \n\t\t\t\"gutter\": \".masonry__gutter-sizer\", \n\t\t\t\"itemSelector\": \".archive__grid__griditem\"\n};\n\nvar masonryIsActive = false;\n\n( function( $ ){\n\n\t$( document ).ready( function() {\n\n\t\tvar $body = $('body');\n\n\t\tif ( $grid === undefined ) {\n\t\t\t$grid = $('.archive__grid__masonry');\n\t\t}\n\n\t\tif ( 'object' == typeof FWP ) { \n\t\t    wp.hooks.addFilter('facetwp/template_html', function(resp, params) {\n\t\t        if ( FWP.is_load_more ) {\n\t\t            FWP.is_load_more = false;\n\t\t            $('.facetwp-template').append( params.html );\n\t\t            return true;\n\t\t        }\n\t\t        return resp;\n\t\t    });\n\t\t} else {\n\t\t\tconsole.log( 'FWP is not defined yet' );\n\t\t}\n\n\t\t$('.focus').each( function() {\n\t\t\tvar img = $(this).find('.image--main');\n\t\t\timg.on('load', function( e ){\n\t\t\t\tdoFocusTranslate(e.target);\n\t\t\t});\n\t\t});\n\n\t\tvar floated_elements = document.querySelectorAll('.floated');\n\t\tfor (var ii = 0; ii < floated_elements.length; ii++ ) {\n\t\t\tvar equal_element = floated_elements[ii].nextElementSibling,\n\t\t\th = floated_elements[ii].offsetHeight,\n\t\t\tequal_h = equal_element.offsetHeight;\n\t\t\tif ( h > equal_h ) {\n\t\t\t\tequal_element.style.height = h + 'px';\n\t\t\t}\n\t\t}\n\n\t\t$( 'a[data-open=story__modal--gallery]' ).on( 'click', function( e ) {\n\t\t\te.preventDefault();\n\t\t\tvar id = $(this).data('img_id'),\n\t\t\ttargetjQ = $('#story__modal--gallery').find('#' + id);\n\t\t\t$('.orbit').foundation( 'changeSlide', true, targetjQ );\n\t\t});\n\n\t\t$( '#token-form__submit' ).on( 'click', function( e ) {\n\t\t\te.preventDefault();\n\t\t\t$(this).prop( 'disabled',true );\n\t\t\tvar selection = $( '.token-form__collab-select option:selected' ),\n\t\t\tgrid = $('.grid--form-options'),\n\t\t\tprToken = getUrlVars().pr;\n\t\t\tif ( undefined !== selection ) {\n\t\t\t\tvar data = {\n\t\t\t\t\taction: 'exchange_token_form',\n\t\t\t\t\tupdate_id : selection.val(),\n\t\t\t\t\tprid : selection.data('programme-round'),\n\t\t\t\t\ttoken : prToken,\n\t\t\t\t\tsecurity : $( '.token-form__nonce' ).val()\n\t\t\t\t};\n\t\t\t\t$('.loader-pointer').remove();\n\t\t\t\t$('.loader-wrapper').addClass('go');\n\t\t\t\tgrid.html('');\n\t\t\t\t$.ajax( {\n\t\t\t\t\t'url':    exchange_ajax.ajax_url,\n\t\t\t\t\t'method': 'POST',\n\t\t\t\t\t'data':   data\n\t\t\t\t} ).done( function ( response ) {\n\t\t\t\t\tgrid.html( response );\n\t\t\t\t\t$('.loader-wrapper').removeClass('go');\n\t\t\t\t\t$(this).removeProp('disabled');\n\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\t$('.translatedparagraph--has_translations').each( function() {\n\t\t\tvar select = $( this ).find('.translation-select');\n\t\t\tselect.on('change', function() {\n\t\t\t\tvar lang = 'paragraph--' + this.value;\n\t\t\t\tfunction doLanguageSwitch( lang ) {\n\t\t\t\t\treturn function( index, element) {\n\t\t\t\t\t\t$( this ).removeClass('show');\n\t\t\t\t\t\tif ( $( this ).hasClass( lang ) ) {\n\t\t\t\t\t\t\t$( this ).addClass('show');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvar wrapper = $( this ).parent().parent('.translatedparagraph--has_translations');\n\t\t\t\tparagraphs = wrapper.children('.translatedparagraph__paragraph');\n\t\t\t\tparagraphs.each( doLanguageSwitch( lang ) );\n\t\t\t});\n\t\t});\n\n\t\tif ( $body.hasClass('single') || $body.hasClass('page-child') ) {\n\t\t\t$('#main').on('scrollme.zf.trigger', handleScroll);\n\t\t}\n\n\t\tif ( $body.hasClass( 'archive' ) || $body.hasClass( 'page-template-archive' ) || $body.hasClass( 'search' ) || $('.featuredgrid__masonry').length === 1 ) {\n\t\t\tif ( $body.hasClass( 'post-type-archive-participant') ) {\n\t\t\t\tif ( archiveMap === undefined ) {\n\t\t\t\t\tarchiveMap = getArchiveMap();\n\t\t\t\t}\n\t\t\t\tif ( archiveMap ) {\t\t\t\t\n\t\t\t\t\tarchiveMap.map.fitBounds( archiveMap.clusterLayer.getBounds() );\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( $grid !== undefined ) {\n\t\t\t\t$grid.masonry( masonryOptions ); // re-initialize\n\t\t\t\tmasonryIsActive = true;\n\t\t\t}\n\t\t}\n\n    \t$('#facet-tabs').on( 'change.zf.tabs', function() {\n\t\t\tif ( archiveMap === undefined ) {\n\t\t\t\tarchiveMap = getArchiveMap();\n\t\t\t}\n\t\t\tif ( archiveMap.map !== undefined ) {\n\t\t\t\tarchiveMap.map.invalidateSize().fitBounds( archiveMap.clusterLayer.getBounds() );\n\t\t\t}\n\t\t\tif ( $grid !== undefined ) {\n\t\t\t\t$grid.masonry( masonryOptions ); // re-initialize\n\t\t\t\tmasonryIsActive = true;\n\t\t\t}\n\t\t});\n\n\t\t$('#facet-switch').on( 'click', function() {\n\t\t\t('#main').foundation('toggle');\n\t\t});\n\n\t\t// Remove empty P tags created by WP inside of Accordion and Orbit\n\t\t$('.accordion p:empty, .orbit p:empty').remove();\n\n\t\t// Makes sure last grid item floats left\n\t\t$('.archive__grid .columns', 'relatedgrid .columns').last().addClass( 'end' );\n\n\t\t// Adds Flex Video to YouTube and Vimeo Embeds\n\t\t$('iframe[src*=\"youtube.com\"], iframe[src*=\"vimeo.com\"]').each( function() {\n\t\t\tif ( $(this).innerWidth() / $(this).innerHeight() > 1.5 ) {\n\t\t\t\t$(this).wrap(\"<div class='widescreen flex-video'/>\");\n\t\t\t} else {\n\t\t\t\t$(this).wrap(\"<div class='flex-video'/>\");\n\t\t\t}\n\t\t});\n\t});\n\n\t $(document).on('click', '.fwp-load-more', function() {\n\n        $('.fwp-load-more').html('Loading...');\n        FWP.is_load_more = true;\n        FWP.paged = parseInt( FWP.settings.pager.page ) + 1;\n        FWP.soft_refresh = true;\n        FWP.refresh();\n\n    });\n\n\t$(document).on('facetwp-loaded', function() {\n\t\t\n\t\topenFacets();\n\n\t\t$grid = $('.archive__grid__masonry');\n\n\t\tif ( masonryIsActive ) {\n\t\t    $grid.masonry('destroy'); // destroy\n\t\t}\n\n\t\t$grid.masonry( masonryOptions ); // re-initialize\n\t\t\n\t\tmasonryIsActive = true;\n\n\t\t// if ( undefined !== FWP_HTTP.archive_args ) {\n\t\t// \t$('#main').addClass('facets-active');\n\t\t// \tFWP.facets[FWP_HTTP.archive_args.taxonomy] = [FWP_HTTP.archive_args.term];\n\t\t// \t$('div[data-value=\"' + FWP_HTTP.archive_args.term + '\"]').addClass('checked');\n\t\t// }\n\n\t\tif ( FWP.settings.pager.page < FWP.settings.pager.total_pages ) {\n\t\t    $('.fwp-load-more').show();\n\t\t} else {\n\t\t    $('.fwp-load-more').hide();\n\t\t}\n\n\t\tif ( FWP.settings.pager.page > 1 ) {\n\t\t\t$('html, body').animate( {\n\t            scrollTop: $('.archive__grid__masonry').offset().bottom\n\t        }, 1000);\n        }\n\n\n\t\tarchiveMap = getArchiveMap();\n\t\t\n\t\tif ( archiveMap === undefined ) {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tvar allObjects = window['leaflet_objects_' + archiveMap.hash];\n\t\t\n\t\tif ( allObjects === undefined || allObjects.map_polylines.length === 0 || FWP.settings.matches.length === 0 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( allObjects.map_polylines.length > 0 && FWP.settings.matches.length > 0 ) {\n\t\t\tvar matchedPolylines = allObjects.map_polylines.filter( function( p ) {\n\t\t\t\tif (  FWP.settings.matches.includes( p.id ) ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif ( matchedPolylines.length > 0 ) {\n\t\t\t\tvar refreshObjects = {\n\t\t\t\t\tmap_polylines : matchedPolylines\n\t\t\t\t};\n\t\t\t\tarchiveMap.renderObjects( refreshObjects );\n\t\t\t}\n\t\t}\n\n\t});\n\n    $(document).on('facetwp-refresh', function() {\n        if ( ! FWP.loaded ) {\n            FWP.paged = 1;\n        }\n    });\n\n})(jQuery);\n","jQuery(document).foundation();"],"sourceRoot":"/source/"}