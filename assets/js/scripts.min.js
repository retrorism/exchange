function handleScroll(){var e=pageYOffset;jQuery(window).scroll(function(){var a=jQuery(this).scrollTop();e=a,pageYOffset<100?jQuery(".breadcrumbs-bar").removeClass("scrolled"):jQuery(".breadcrumbs-bar").addClass("scrolled")})}function getArchiveMap(){if(void 0!==Exchange&&void 0!==Exchange.PluginExtensions&&void 0!==Exchange.PluginExtensions.LMP&&void 0!==Exchange.PluginExtensions.LMP.maps){for(var e in Exchange.PluginExtensions.LMP.maps)if(Exchange.PluginExtensions.LMP.maps.hasOwnProperty(e)){archiveMap=Exchange.PluginExtensions.LMP.maps[e],archiveMap.hash=e.slice(4);break}return archiveMap?archiveMap:void 0}}function getUrlVars(){for(var e,a=[],t=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),r=0;r<t.length;r++)e=t[r].split("="),a.push(e[0]),a[e[0]]=e[1];return a}function getFocusTranslate(e,a){if(img_data=e.parentNode.dataset,!img_data)return!1;var t=a.clientHeight,r=e.offsetHeight,i=img_data.focus_h*t-r/2,n=(t-r)/t*100,o=i/t*100;return!(i<0||o<0)&&(o>n?n:o)}function doFocusTranslate(e){var a=e.parentNode;if(translate=getFocusTranslate(a,e),translate){var t=translate>0?-1*translate:translate,r="transform: translateY("+t+"%);";e.setAttribute("style",r)}}function openFacets(){var e=!1,a=[];if(jQuery(".accordion-item").each(function(){var t=jQuery(this),r=t.find("a.accordion-title"),i=t.children(".accordion-content"),n=i.children().children(".facetwp-checkbox"),o=0;if(r){var s=r.clone().children().remove().end().text().trim();a.push({name:s,terms:[]}),n.each(function(){if(jQuery(this).hasClass("checked")){e=!0,t.addClass(".is-active"),o++;var r=a[a.length-1];r.terms.push(jQuery(this).clone().children().remove().end().text().trim())}})}t.find("span.filter-count").html(""),o>0&&t.find("span.filter-count").html(" ("+o+")")}),e&&jQuery("#main").addClass("facets-active"),a){var t="";e&&(t+="<h4>Showing results for:</h4>"),a.map(function(e){if(e.terms.length>0){t+='<ul class="term-list" data-value="'+e.name+'">';for(var a=0;e.terms.length>a;a++)t+='<li class="term" title="'+e.name+": "+e.terms[a]+'">'+e.terms[a]+"</li>";t+="</ul>"}}),jQuery(".archive__active-facet-summary").html(t)}}jQuery(document).foundation();var archiveMap,$grid,masonryOptions={percentPosition:!0,columnWidth:".masonry__grid-sizer",gutter:".masonry__gutter-sizer",itemSelector:".archive__grid__griditem"},masonryIsActive=!1;!function(e){e(document).ready(function(){var a=e("body");void 0===$grid&&($grid=e(".archive__grid__masonry")),"object"==typeof FWP?wp.hooks.addFilter("facetwp/template_html",function(a,t){return FWP.is_load_more?(FWP.is_load_more=!1,e(".facetwp-template").append(t.html),!0):a}):console.log("FWP is not defined yet"),e(".focus").each(function(){var a=e(this).find(".image--main");a.on("load",function(e){doFocusTranslate(e.target)})});for(var t=document.querySelectorAll(".floated"),r=0;r<t.length;r++){var i=t[r].nextElementSibling,n=t[r].offsetHeight,o=i.offsetHeight;n>o&&(i.style.height=n+"px")}e("a[data-open=story__modal--gallery]").on("click",function(a){a.preventDefault();var t=e(this).data("img_id"),r=e("#story__modal--gallery").find("#"+t);e(".orbit").foundation("changeSlide",!0,r)}),e("#token-form__submit").on("click",function(a){a.preventDefault(),e(this).prop("disabled",!0);var t=e(".token-form__collab-select option:selected"),r=e(".grid--form-options"),i=getUrlVars().pr;if(void 0!==t){var n={action:"exchange_token_form",update_id:t.val(),prid:t.data("programme-round"),token:i,security:e(".token-form__nonce").val()};e(".loader-pointer").remove(),e(".loader-wrapper").addClass("go"),r.html(""),e.ajax({url:exchange_ajax.ajax_url,method:"POST",data:n}).done(function(a){r.html(a),e(".loader-wrapper").removeClass("go"),e(this).removeProp("disabled")})}}),e(".translatedparagraph--has_translations").each(function(){var a=e(this).find(".translation-select");a.on("change",function(){function a(a){return function(t,r){e(this).removeClass("show"),e(this).hasClass(a)&&e(this).addClass("show")}}var t="paragraph--"+this.value,r=e(this).parent().parent(".translatedparagraph--has_translations");paragraphs=r.children(".translatedparagraph__paragraph"),paragraphs.each(a(t))})}),(a.hasClass("single")||a.hasClass("page-child"))&&e("#main").on("scrollme.zf.trigger",handleScroll),(a.hasClass("archive")||a.hasClass("page-template-archive")||a.hasClass("search")||1===e(".featuredgrid__masonry").length)&&(a.hasClass("post-type-archive-participant")&&(void 0===archiveMap&&(archiveMap=getArchiveMap()),archiveMap&&archiveMap.map.fitBounds(archiveMap.clusterLayer.getBounds())),void 0!==$grid&&($grid.masonry(masonryOptions),masonryIsActive=!0)),e("#facet-tabs").on("change.zf.tabs",function(){void 0===archiveMap&&(archiveMap=getArchiveMap()),void 0!==archiveMap.map&&archiveMap.map.invalidateSize().fitBounds(archiveMap.clusterLayer.getBounds()),void 0!==$grid&&($grid.masonry(masonryOptions),masonryIsActive=!0)}),e("#facet-switch").on("click",function(){"#main".foundation("toggle")}),e(".accordion p:empty, .orbit p:empty").remove(),e(".archive__grid .columns","relatedgrid .columns").last().addClass("end"),e('iframe[src*="youtube.com"], iframe[src*="vimeo.com"]').each(function(){e(this).innerWidth()/e(this).innerHeight()>1.5?e(this).wrap("<div class='widescreen flex-video'/>"):e(this).wrap("<div class='flex-video'/>")})}),e(document).on("click",".fwp-load-more",function(){e(".fwp-load-more").html("Loading..."),FWP.is_load_more=!0,FWP.paged=parseInt(FWP.settings.pager.page)+1,FWP.soft_refresh=!0,FWP.refresh()}),e(document).on("facetwp-loaded",function(){if(openFacets(),$grid=e(".archive__grid__masonry"),masonryIsActive&&$grid.masonry("destroy"),$grid.masonry(masonryOptions),masonryIsActive=!0,FWP.settings.pager.page<FWP.settings.pager.total_pages?e(".fwp-load-more").show():e(".fwp-load-more").hide(),FWP.settings.pager.page>1&&e("html, body").animate({scrollTop:e(".archive__grid__masonry").offset().bottom},1e3),archiveMap=getArchiveMap(),void 0!==archiveMap){var a=window["leaflet_objects_"+archiveMap.hash];if(void 0!==a&&0!==a.map_polylines.length&&0!==FWP.settings.matches.length&&a.map_polylines.length>0&&FWP.settings.matches.length>0){var t=a.map_polylines.filter(function(e){if(FWP.settings.matches.includes(e.id))return!0});if(t.length>0){var r={map_polylines:t};archiveMap.renderObjects(r)}}}}),e(document).on("facetwp-refresh",function(){FWP.loaded||(FWP.paged=1)})}(jQuery);
//# sourceMappingURL=scripts.min.js.map
