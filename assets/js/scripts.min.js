function isEmpty(e){if(null==e)return!0;if(e.length>0)return!1;if(0===e.length)return!0;if("object"!=typeof e)return!0;for(var a in e)if(hasOwnProperty.call(e,a))return!1;return!0}function createRoute(e,a,t){var r=leaflet_vars.markerUrl,o=(L.icon({iconUrl:r,iconSize:[14,14],shadowSize:[0,0],iconAnchor:[7,7],shadowAnchor:[4,62],popupAnchor:[0,0]}),L.featureGroup({snakingPause:500}));if(e.length>0&&a.length>0){for(i=0;i<a.length;i++){var n=L.marker(e[i],{icon:new L.DivIcon({className:"map__marker",html:'<img class="map__marker__image" src="'+r+'"><span class="map__marker__label">'+t[i]+"</span>"})}),s=L.polyline(a[i],{color:leaflet_vars.yellowTandem,className:"map__line",weight:6,opacity:.9,dashArray:"12, 10",lineJoin:"round",snakingSpeed:200});o.addLayer(n).addLayer(s)}if(1==a.length){var l=L.marker(e[i],{icon:new L.DivIcon({className:"map__marker",html:'<img class="map__marker__image" src="'+r+'"><span class="map__marker__label">'+t[i]+"</span>"})});l.bindPopup(t[i]),o.addLayer(l)}}return o}function getQueryTag(e,a){var t=document.createElement("a"),r=document.createElement("li"),o=document.createTextNode(e.name);return t.setAttribute("data-term_id",e.id),t.setAttribute("data-slug",e.slug),t.setAttribute("data-tax",e.tax),t.setAttribute("title",e.name),t.setAttribute("href","#"),t.addEventListener("click",function(e){e.preventDefault(),a.removeAttr("selected"),console.log(a),this.remove()}),t.className="tag query-tag "+e.tax,t.appendChild(o),r.appendChild(t),r}function fetchCollaborationsQuery(){alert("called");var e=jQuery(".archive__filter__query-tags").find("a.tag");console.log(e);var a={object:"collaborations"};if(e.length){for(var t=0;t<e.length;t++){var r=e[t].data("tax"),o=e[t].data("slug");("string"==typeof r||r instanceof String)&&("string"==typeof o||o instanceof String)&&(a.taxquery[r]=o)}if(taxquery=a.taxquery,queryFilters="",isEmpty(taxquery))throw new Error("No filters given");for(var n in taxquery)taxquery.hasOwnProperty(n)&&(queryFilters+="&filter["+n+"]="+taxquery[n]);var i="?filter[post_status]=publish"+queryFilters+"&filter[orderby]=date&filter[order]=desc",s="/wp-json/wp/v2/"+a.object,l=baseUrl+s+i;return console.log(l),l}console.log(a)}function fetchCollaborations(){var e=fetchCollaborationsQuery();null!==e&&jQuery.when(jQuery.ajax({url:e,method:"GET",crossDomain:!0,contentType:"application/json"})).then(function(e,a,t){for(var r=e.length,o=[],n=0;n<r;n++)o.push(e[n].exchange_basics.data);collectionLength=o.length;for(var i=0;i<collectionLength;i++){var s=prepareCollaborationMarkers(o[i]);console.log(s),s.addTo(map)}})}function prepareCollaborationMarkers(e){var a=[],t=[],r=[],o=[];if(isEmpty(e.locations))throw new Error("no locations found");for(var n in e.locations)if(e.locations.hasOwnProperty(n)){var i=e.locations[n],s=[];jQuery.isNumeric(i.org_lat)&&s.push(i.org_lat),jQuery.isNumeric(i.org_lng)&&s.push(i.org_lng),2==s.length&&a.push(s),""!=i.org_city&&r.push(i.org_city)}for(var l=a.length,c=0;c<l;c++)t.push(a[c]),c===l-1?l>2&&o.push([a[c],a[0]]):o.push([a[c],a[c+1]]);2==l&&t.push(a[1]);var u=createRoute(t,o,r);return u}jQuery(document).foundation();var hasOwnProperty=Object.prototype.hasOwnProperty,baseUrl=location.origin,map;location.origin||(baseUrl=location.protocol+"//"+location.host),"http://localhost"==location.origin&&(baseUrl=location.origin+"/tandem");var getFocusTranslate=function(e,a){if(img_data=e.parentNode.dataset,!img_data)return!1;var t=a.offsetHeight,r=e.offsetHeight,o=img_data.focus_h*t-r/2,n=(t-r)/t*100,i=o/t*100;return!(o<0||i<0)&&(i>n?n:i)},doFocusTranslate=function(e){var a=e.parentNode;if(translate=getFocusTranslate(a,e),translate){var t=translate>0?-1*translate:translate,r="transform: translateY("+t+"%);";e.setAttribute("style",r)}};jQuery(document).foundation(),jQuery(document).ready(function(){for(var e=document.querySelectorAll(".focus"),a=0;a<e.length;a++){var t=e[a];img=t.getElementsByClassName("image--main")[0],img.classList.contains("lazy")||doFocusTranslate(img)}for(var r=document.querySelectorAll(".floated"),o=0;o<r.length;o++){var n=r[o].nextElementSibling,i=r[o].offsetHeight,s=n.offsetHeight;i>s&&(n.style.height=i+"px")}if(jQuery(".translatedparagraph--has_translations").each(function(){var e=jQuery(this).find(".translation-select");e.on("change",function(){function e(e){return function(a,t){jQuery(this).removeClass("show"),jQuery(this).hasClass(e)&&jQuery(this).addClass("show")}}var a="paragraph--"+this.value,t=jQuery(this).parent().parent(".translatedparagraph--has_translations");paragraphs=t.children(".translatedparagraph__paragraph"),paragraphs.each(e(a))})}),jQuery(".image--main").each(function(){console.log(jQuery(this).height())}),jQuery(".accordion p:empty, .orbit p:empty").remove(),jQuery(".archive__grid .columns","relatedgrid .columns").last().addClass("end"),jQuery('iframe[src*="youtube.com"], iframe[src*="vimeo.com"]').each(function(){jQuery(this).innerWidth()/jQuery(this).innerHeight()>1.5?jQuery(this).wrap("<div class='widescreen flex-video'/>"):jQuery(this).wrap("<div class='flex-video'/>")}),jQuery("body").hasClass("archive")){var l=jQuery(".archive__grid").masonry({itemSelector:".archive__grid__griditem"});jQuery(".archive__filter__button").each(function(){jQuery(this).on("click",function(){var e=jQuery(this).data("tax"),a=jQuery(this).parent().find(".archive__filter__datalist"),t=a.val();if(null!==t&&void 0!==t&&""!==t){var r=jQuery(".archive__filter").find(".archive__filter__tax-datalist[data-tax="+e+"]").find('option[value="'+t+'"]:not(:selected)');if(r.length){var o=r.data();o.name=t,o.tax=e;var n=getQueryTag(o,r);jQuery(".archive__filter__query-tags ul").append(n),r.attr("selected","selected")}a.val("")}})}),jQuery(".archive__button").on("click",function(e){e.preventDefault();var a=jQuery(this),t=a.data("paged"),r=a.data("max_num_pages"),o=a.data("object"),n=a.data("posts_per_page"),i=a.data("tax_query");i?(restBase="/wp-json/exchange/v1/"+o+"/"+i,filters="?page="+(t+2)+"&posts_per_page="+n):(restBase="/wp-json/wp/v2/"+o,filters="?filter[post_status]=publish&filter[posts_per_page]="+n+"&page="+(t+2)+"&filter[orderby]=date&filter[order]=desc");var s=baseUrl+restBase+filters;t+1<r&&jQuery.ajax({url:s,method:"GET",crossDomain:!0,contentType:"application/json",success:function(e,o,n){console.log(s);for(var i=e.length,c="",u=0;u<i;u++)c+=e[u].exchange_basics.griditem;var p=jQuery(c);l.append(p).masonry("appended",p).masonry(),t+=1,a.data("paged",t),t+1==r&&a.hide()},error:function(e){console.log(e)}})})}if(jQuery("body").hasClass("post-type-archive-collaboration")){var c="https://api.mapbox.com/styles/v1/retrorism/cio2pv2ft001ybvm8qb4da6f9/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoicmV0cm9yaXNtjwiYSI6IlhRWTE0d2cifQ.-Wi_jReZU4Wz_owPnVZDwQ",u=L.tileLayer(c,{subdomains:"1234"});map=L.map("leaflet-archive-map",{layers:[u],maxZoom:20,minZoom:0,zoomControl:1,scrollWheelZoom:0,attributionControl:!1}).setView([48,16],4);var p=L.control.attribution({prefix:!1}).addTo(map);p.addAttribution('Tiles Courtesy of <a href="http://www.mapbox.com/" target="_blank">MapBox</a> Â© <a href="http://www.openstreetmap.org/">OpenStreetMap</a> contributors'),fetchCollaborations()}});
//# sourceMappingURL=scripts.min.js.map
